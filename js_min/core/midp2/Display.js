(function(f,c){function e(){this.m_HTMLDivElement=document.createElement("div");this.m_HTMLDivElement.className+=" gameloft-display-div";LowAPI.applyStyle(this.m_HTMLDivElement,e.DEFAULT_CSS_STYLE);e.getRootDiv().appendChild(this.m_HTMLDivElement);this.m_CurentDisplayable=null}function d(){if(!h.isPainting){return}var j=h.canvas.getContext("2d");if(h.bgImage){h.iPaintCount++;if(h.bgImage.width>0){j.drawImage(h.bgImage,0,0,h.bgImage.width,h.bgImage.height,0,0,h.width,h.height);h.bgImage.width=0;h.bgImage.height=0}if(a.loadingBar){j.drawImage(a.loadingBar,0,0,a.loadingBar.width,a.loadingBar.height,a.offsetX,a.offsetY,a.width,a.height);if(a.loadingProgess){var o=a.width-(2*a.offsetProgessX);var k=(o*a.iPercent/100)|0;j.drawImage(a.loadingProgess,0,0,a.loadingProgess.width,a.loadingProgess.height,a.offsetX+a.offsetProgessX,a.offsetY+a.offsetProgessY,k,a.height-(2*a.offsetProgessY))}if(a.iText>=0){var m=a.textImages[a.iText];if(m){if(m.iInterval==c||h.iPaintCount%2!=0){var n=a.offsetX+((a.width-m.width)/2)|0;var l=a.offsetY+((a.height-m.height)/2)|0;j.drawImage(m,0,0,m.width,m.height,n,l,m.width,m.height)}if(m.iInterval){setTimeout(d,m.iInterval)}}}}}}e.ShowSystemLoading=function(j,l,k){LowAPI.applyStyle(h.container,{display:j?"block":"none"});if(j){h.isPainting=true;if(l==c){l=0}l=l|0;if(l>100){l=100}if(l<0){l=0}if(k==c){k=0}k=k|0;a.iPercent=l;a.iText=k;d()}else{h.isPainting=false}};var b=Device.isTouchDevice?"touchend":"mouseup";var i=function(){if(e.requireUserInputEvent_cb){e.ShowSystemLoading(true,100,-1);var j=h.canvas;j.removeEventListener(b,i,false);e.requireUserInputEvent_cb();e.requireUserInputEvent_cb=false}};e.requireUserInputEvent_cb=false;e.requireUserInputEvent=function(j){e.requireUserInputEvent_cb=j;var k=h.canvas;k.addEventListener(b,i,false);e.ShowSystemLoading(true,100,1)};e.getRootDiv=function(){var j=document.getElementById("gameloft-root-div");if(j=="undefined"||j==null){throw new Error("Can not found element id gameloft-game-div")}return j};e.setDefaultStyle=function(j){var k=e.DEFAULT_CSS_STYLE;if(typeof k=="undefined"){k={}}e.DEFAULT_CSS_STYLE=LowAPI.extendObject(k,j)};e.getDisplay=function(j){if(typeof e.s_all_displays=="undefined"){e.s_all_displays=[]}if(typeof e.s_all_displays[j.m_inst_id]=="undefined"){e.s_all_displays[j.m_inst_id]=new e()}return e.s_all_displays[j.m_inst_id]};e.freeSplash=function(){h={iPaintCount:0,isPainting:false,canvas:null,bgImage:null,width:0,height:0};a={iPercent:0,loadingBar:null,loadingProgess:null,textImages:[],width:0,height:0};h=null;a=null};e.prototype.getCurrent=function(){return this.m_CurentDisplayable};e.prototype.setCurrent=function(l){if(this.m_CurentDisplayable!=l){this.m_CurentDisplayable=l;this.m_HTMLDivElement.innerHTML="";if(this.m_CurentDisplayable!=null){this.m_HTMLDivElement.appendChild(this.m_CurentDisplayable.getHTMLElement());var o=this.m_HTMLDivElement.getBoundingClientRect();var j=o.width/(GLLibConfig.screenWidth);var r=o.height/(GLLibConfig.screenHeight);var p=Math.min(j,r);var n=LowAPI.Float2Int(GLLibConfig.screenWidth*p);var q=LowAPI.Float2Int(GLLibConfig.screenHeight*p);var m=LowAPI.Float2Int((o.width-n)/2);var k=LowAPI.Float2Int((o.height-q)/2);this.m_CurentDisplayable.onresize(m,k,n,q,p);e.onVisible(true)}}};e.onVisible=function(k){if(e.s_all_displays){for(var l=0,j=e.s_all_displays.length;l<j;l++){if(e.s_all_displays[l].m_CurentDisplayable!=null){e.s_all_displays[l].m_CurentDisplayable.onVisible(k)}}}};var h={iPaintCount:0,isPainting:false,canvas:null,bgImage:null,width:0,height:0};var a={iPercent:0,loadingBar:null,loadingProgess:null,textImages:[],width:0,height:0};(function g(p,l){e.setDefaultStyle({background:"#000000",});h.width=p;h.height=l;var y=document.createElement("img");y.src=_ROOT_SCRIPT_PATH_+"/loading/splash.png?v="+VERSION;y.onload=function(){h.bgImage=y;y=null;d()};var r=document.createElement("img");r.src=_ROOT_SCRIPT_PATH_+"/loading/bar.png?v="+VERSION;r.onload=function(){a.loadingBar=r;a.offsetX=((p-r.width)/2)|0;a.offsetY=650;a.offsetProgessX=5;a.offsetProgessY=5;a.width=r.width;a.height=r.height;d()};var s=document.createElement("img");s.src=_ROOT_SCRIPT_PATH_+"/loading/progess.png?v="+VERSION;s.onload=function(){a.loadingProgess=s;d()};var n=document.createElement("img");n.src=_ROOT_SCRIPT_PATH_+"/loading/loading.png?v="+VERSION;n.onload=function(){a.textImages[0]=n;d()};var v=document.createElement("img");v.src=_ROOT_SCRIPT_PATH_+"/loading/touch.png?v="+VERSION;v.onload=function(){a.textImages[1]=v;a.textImages[1].iInterval=500;d()};var t=document.createElement("img");t.src=_ROOT_SCRIPT_PATH_+"/loading/waiting.png?v="+VERSION;t.onload=function(){a.textImages[2]=t;d()};h.container=document.createElement("div");h.container.id="fastest_splash";e.getRootDiv().appendChild(h.container);LowAPI.applyStyle(h.container,{position:"absolute",top:"0px",left:"0px",width:"100%",height:"100%",background:"#000000","z-index":9999,});var q=e.getRootDiv().getBoundingClientRect();var j=q.width/(p);var x=q.height/(l);var u=Math.min(j,x);var o=LowAPI.Float2Int(p*u);var w=LowAPI.Float2Int(l*u);var m=LowAPI.Float2Int((q.width-o)/2);var k=LowAPI.Float2Int((q.height-w)/2);h.canvas=document.createElement("canvas");h.canvas.id="splashCanvas";h.container.appendChild(h.canvas);h.canvas.width=p;h.canvas.height=l;LowAPI.applyStyle(h.canvas,{width:o+"px",height:w+"px","min-width":o+"px","min-height":w+"px",position:"relative",left:m+"px",top:k+"px",});e.ShowSystemLoading(true,0,0)})(480,800);LowAPI.extendObject(f,{Display:e,},true)})(window);