(function(b,c){GLLibPlayer.k_snd_nbChannel=GLLibConfig.sound_numberOfChannels;GLLibPlayer.k_snd_nbMidiChannel=16;GLLibPlayer.k_snd_max_volume=100;GLLibPlayer.k_snd_command_dummy=0;GLLibPlayer.k_snd_command_prepare=GLLibPlayer.k_snd_command_dummy+1;GLLibPlayer.k_snd_command_free=GLLibPlayer.k_snd_command_prepare+1;GLLibPlayer.k_snd_command_play=GLLibPlayer.k_snd_command_free+1;GLLibPlayer.k_snd_command_stop=GLLibPlayer.k_snd_command_play+1;GLLibPlayer.k_snd_command_pause=GLLibPlayer.k_snd_command_stop+1;GLLibPlayer.k_snd_command_resume=GLLibPlayer.k_snd_command_pause+1;GLLibPlayer.k_snd_command_amount=GLLibPlayer.k_snd_command_resume+1;GLLibPlayer.k_snd_state_unprepared=0;GLLibPlayer.k_snd_state_ready=GLLibPlayer.k_snd_state_unprepared+1;GLLibPlayer.k_snd_state_playing=GLLibPlayer.k_snd_state_ready+1;GLLibPlayer.k_snd_state_paused=GLLibPlayer.k_snd_state_playing+1;GLLibPlayer.k_snd_queue_command=0;GLLibPlayer.k_snd_queue_index=GLLibPlayer.k_snd_queue_command+1;GLLibPlayer.k_snd_queue_priority=GLLibPlayer.k_snd_queue_index+1;GLLibPlayer.k_snd_queue_volume=GLLibPlayer.k_snd_queue_priority+1;GLLibPlayer.k_snd_queue_loop=GLLibPlayer.k_snd_queue_volume+1;GLLibPlayer.k_snd_queue_size=GLLibPlayer.k_snd_queue_loop+1;GLLibPlayer.k_snd_fade_command=0;GLLibPlayer.k_snd_fade_final_value=GLLibPlayer.k_snd_fade_command+1;GLLibPlayer.k_snd_fade_speed=GLLibPlayer.k_snd_fade_final_value+1;GLLibPlayer.k_snd_fade_size=GLLibPlayer.k_snd_fade_speed+1;GLLibPlayer.k_snd_fade_crt_volume=GLLibPlayer.k_snd_fade_size;GLLibPlayer.k_snd_fade_minActiveLength=GLLibPlayer.k_snd_fade_crt_volume+1;GLLibPlayer.k_snd_fade_maxActiveLength=GLLibPlayer.k_snd_fade_minActiveLength+1;GLLibPlayer.k_snd_fade_minSilentLength=GLLibPlayer.k_snd_fade_maxActiveLength+1;GLLibPlayer.k_snd_fade_maxSilentLength=GLLibPlayer.k_snd_fade_minSilentLength+1;GLLibPlayer.k_snd_fade_activeTimer=GLLibPlayer.k_snd_fade_maxSilentLength+1;GLLibPlayer.k_snd_fade_midi_size=GLLibPlayer.k_snd_fade_activeTimer+1;GLLibPlayer.k_snd_fade_command_None=0;GLLibPlayer.k_snd_fade_command_Maintain=1;GLLibPlayer.k_snd_fade_command_FadeMidiChannelVolume=2;GLLibPlayer.k_snd_fade_command_FadeVolume=3;GLLibPlayer.k_snd_fade_command_FadeOutAndStop=4;GLLibPlayer.k_snd_fade_command_FadeTempo=5;GLLibPlayer.k_snd_fade_command_RandomlyActivateMidiChannelOn=6;GLLibPlayer.k_snd_fade_command_RandomlyActivateMidiChannelOff=7;GLLibPlayer.k_snd_fade_loopingfix_state_Normal=0;GLLibPlayer.k_snd_fade_loopingfix_state_LoopTransition=1;GLLibPlayer.k_snd_fade_loopingfix_state_StopDetected=2;GLLibPlayer.k_snd_fade_loopingfix_state_Restarted=3;GLLibPlayer.k_snd_max_midi_channel_volume=127;GLLibPlayer.k_snd_same_tempo_threshold=500;GLLibPlayer.k_snd_priority_highest=0;GLLibPlayer.k_snd_priority_normal=7;GLLibPlayer.k_snd_priority_lowest=15;GLLibPlayer.s_snd_masterVolume=0;GLLibPlayer.s_snd_maxNbSoundSlot=0;GLLibPlayer.s_snd_isSoundEngineInitialized=false;GLLibPlayer.s_snd_sndSlot=null;GLLibPlayer.s_snd_sndType=null;GLLibPlayer.s_snd_sndDuration=null;GLLibPlayer.s_snd_sndResourceURL=null;GLLibPlayer.s_snd_IgnoreSoundsOnInterrupt=false;GLLibPlayer.s_snd_Player=null;GLLibPlayer.s_snd_PlayerSlot=null;GLLibPlayer.s_snd_PlayerSlotMultiple=null;GLLibPlayer.s_snd_playTime=null;GLLibPlayer.s_snd_index=null;GLLibPlayer.s_snd_priority=null;GLLibPlayer.s_snd_state=null;GLLibPlayer.s_snd_volume=null;GLLibPlayer.s_snd_loop=null;GLLibPlayer.s_pThread=null;GLLibPlayer.s_pSoundPlayerIns=null;GLLibPlayer.s_snd_queue=null;GLLibPlayer.s_snd_queue_pointer=null;GLLibPlayer.s_snd_queue_size=null;GLLibPlayer.s_snd_queue_priority=null;GLLibPlayer.s_snd_bInUpdate=false;GLLibPlayer.s_snd_requestBuffer=null;GLLibPlayer.s_snd_fade=null;GLLibPlayer.s_snd_fadeTempo=null;GLLibPlayer.s_snd_fadeMidi=null;GLLibPlayer.s_snd_MidiChannelActiveFlags=null;GLLibPlayer.s_snd_fadeParamsNeedRefresh=null;GLLibPlayer.s_snd_fadeLoopingFixState=null;GLLibPlayer.s_snd_fadeDeltaTime=0;GLLibPlayer.s_data_mimeType=null;GLLibPlayer.Snd_GetFreePlayer=function(e){var h=null;if(GLLibConfig.sound_enable){if(GLLibConfig.sound_allowMultiplePlayersPerSlot){if(!(GLLibPlayer.s_snd_PlayerSlotMultiple!=null)){Assert(false,"Snd_GetPlayer: Player array is null! Must call Snd_Init")}if(!(e>=0)){Assert(false,"Snd_GetPlayer: Index is negative ["+e+"]")}if(!(e<GLLibPlayer.s_snd_maxNbSoundSlot)){Assert(false,"Snd_GetPlayer: Index ["+e+"] is out of range. Max slots is "+GLLibPlayer.s_snd_maxNbSoundSlot)}if(GLLibPlayer.s_snd_PlayerSlotMultiple[e]==null){h=null}else{var k=GLLibPlayer.s_snd_PlayerSlotMultiple[e];for(var g=0;g<k.length;g++){var f=k[g];var d=false;for(var j=0;j<GLLibPlayer.s_snd_Player.length;j++){if(GLLibPlayer.s_snd_Player[j]==f){if(GLLibPlayer.Snd_IsPlaying(j)){d=true}else{GLLibPlayer.Snd_FreeChannelExec(j)}}}if(!d){h=f;break}}}}else{if(!(GLLibPlayer.s_snd_PlayerSlot!=null)){Assert(false,"Snd_GetPlayer: Player array is null! Must call Snd_Init")}if(!(e>=0)){Assert(false,"Snd_GetPlayer: Index is negative ["+e+"]")}if(!(e<GLLibPlayer.s_snd_maxNbSoundSlot)){Assert(false,"Snd_GetPlayer: Index ["+e+"] is out of range. Max slots is "+GLLibPlayer.s_snd_maxNbSoundSlot)}h=GLLibPlayer.s_snd_PlayerSlot[e]}}return h};GLLibPlayer.SndQueue_NormalizeIndex=function(d){while(d>=GLLibConfig.sound_maxQueueLength){d-=GLLibConfig.sound_maxQueueLength}while(d<0){d+=GLLibConfig.sound_maxQueueLength}return d};GLLibPlayer.SndQueue_GetIndex=function(e,d){return(e*GLLibConfig.sound_maxQueueLength*GLLibPlayer.k_snd_queue_size+d*GLLibPlayer.k_snd_queue_size)};GLLibPlayer.SndQueue_Push_Normal=function(l,f,k,m,h,j){if(!GLLibPlayer.s_snd_isSoundEngineInitialized){return}if(!(GLLibPlayer.s_snd_queue_size[l]<GLLibConfig.sound_maxQueueLength)){Assert(false,"SndQueue_Push: Too many sound requests given before Snd_Update!")}var d=GLLibPlayer.s_snd_queue_pointer[l];var o=GLLibPlayer.s_snd_queue_size[l];var e=GLLibPlayer.SndQueue_NormalizeIndex(d+o);var n;for(var g=0;g<o;g++){n=GLLibPlayer.SndQueue_NormalizeIndex(e-g-1);n=GLLibPlayer.SndQueue_GetIndex(l,n);if(GLLibPlayer.s_snd_queue[n+GLLibPlayer.k_snd_queue_command]==f){if(((f==GLLibPlayer.k_snd_command_play)||(f==GLLibPlayer.k_snd_command_prepare))&&(GLLibPlayer.s_snd_queue[n+GLLibPlayer.k_snd_queue_priority]<m)){continue}GLLibPlayer.s_snd_queue[n+GLLibPlayer.k_snd_queue_command]=GLLibPlayer.k_snd_command_dummy}}n=GLLibPlayer.SndQueue_GetIndex(l,e);GLLibPlayer.s_snd_queue[n+GLLibPlayer.k_snd_queue_command]=f;GLLibPlayer.s_snd_queue[n+GLLibPlayer.k_snd_queue_index]=k;GLLibPlayer.s_snd_queue[n+GLLibPlayer.k_snd_queue_priority]=m;GLLibPlayer.s_snd_queue[n+GLLibPlayer.k_snd_queue_volume]=h;GLLibPlayer.s_snd_queue[n+GLLibPlayer.k_snd_queue_loop]=j;GLLibPlayer.s_snd_queue_size[l]++};GLLibPlayer.SndQueue_Push=function(h,i,e,f,g,d){var e=e;var f=f;var g=g;var d=d;if(arguments.length<6){e=-1;f=-1;g=-1;d=-1}GLLibPlayer.SndQueue_Push_Normal(h,i,e,f,g,d)};GLLibPlayer.SndQueue_Pop_Normal=function(f,e){e[GLLibPlayer.k_snd_queue_size]=GLLibPlayer.s_snd_queue_size[f];if(GLLibPlayer.s_snd_queue_size[f]>0){var d=GLLibPlayer.SndQueue_GetIndex(f,GLLibPlayer.s_snd_queue_pointer[f]);System.arraycopy(GLLibPlayer.s_snd_queue,d,e,0,GLLibPlayer.k_snd_queue_size);GLLibPlayer.s_snd_queue_pointer[f]=GLLibPlayer.SndQueue_NormalizeIndex(GLLibPlayer.s_snd_queue_pointer[f]+1);GLLibPlayer.s_snd_queue_size[f]--}};GLLibPlayer.SndQueue_Pop=function(e,d){GLLibPlayer.SndQueue_Pop_Normal(e,d)};GLLibPlayer.Snd_Init=function(e){if(!GLLibConfig.sound_enable){return}if(GLLibConfig.sound_useADPCMtoPCMConversion&&GLLibConfig.sound_useCachedPlayers){m_adpcm_index=LoadInternalArray(Arrays.GLLIBPLAYER_ADPCM_INDEX);m_adpcm_data=LoadInternalArray(Arrays.GLLIBPLAYER_ADPCM_DATA)}GLLibPlayer.s_snd_Player=LowAPI.Gen_Array([GLLibPlayer.k_snd_nbChannel],null);if(GLLibConfig.sound_useCachedPlayers){if(GLLibConfig.sound_allowMultiplePlayersPerSlot){GLLibPlayer.s_snd_PlayerSlotMultiple=LowAPI.Gen_Array([e],null)}else{GLLibPlayer.s_snd_PlayerSlot=LowAPI.Gen_Array([e],null)}}GLLibPlayer.s_snd_index=LowAPI.Gen_Array([GLLibPlayer.k_snd_nbChannel],0);GLLibPlayer.s_snd_priority=LowAPI.Gen_Array([GLLibPlayer.k_snd_nbChannel],0);GLLibPlayer.s_snd_state=LowAPI.Gen_Array([GLLibPlayer.k_snd_nbChannel],0);GLLibPlayer.s_snd_volume=LowAPI.Gen_Array([GLLibPlayer.k_snd_nbChannel],0);GLLibPlayer.s_snd_loop=LowAPI.Gen_Array([GLLibPlayer.k_snd_nbChannel],0);GLLibPlayer.s_snd_queue=LowAPI.Gen_Array([GLLibPlayer.k_snd_nbChannel*GLLibConfig.sound_maxQueueLength*GLLibPlayer.k_snd_queue_size],0);GLLibPlayer.s_snd_queue_pointer=LowAPI.Gen_Array([GLLibPlayer.k_snd_nbChannel],0);GLLibPlayer.s_snd_queue_size=LowAPI.Gen_Array([GLLibPlayer.k_snd_nbChannel],0);GLLibPlayer.s_snd_queue_priority=LowAPI.Gen_Array([GLLibPlayer.k_snd_nbChannel],0);GLLibPlayer.s_snd_requestBuffer=LowAPI.Gen_Array([GLLibPlayer.k_snd_queue_size+1],0);if(GLLibConfig.sound_useFader){GLLibPlayer.s_snd_fade=LowAPI.Gen_Array([GLLibPlayer.k_snd_nbChannel*GLLibPlayer.k_snd_fade_size],0);GLLibPlayer.s_snd_fadeTempo=LowAPI.Gen_Array([GLLibPlayer.k_snd_nbChannel*GLLibPlayer.k_snd_fade_size],0);GLLibPlayer.s_snd_fadeMidi=LowAPI.Gen_Array([GLLibPlayer.k_snd_nbChannel*GLLibPlayer.k_snd_nbMidiChannel*GLLibPlayer.k_snd_fade_midi_size],0);GLLibPlayer.s_snd_MidiChannelActiveFlags=LowAPI.Gen_Array([GLLibPlayer.k_snd_nbChannel],0);GLLibPlayer.s_snd_fadeParamsNeedRefresh=LowAPI.Gen_Array([GLLibPlayer.k_snd_nbChannel],false);if(GLLibConfig.sound_useFaderLoopingBugFix){GLLibPlayer.s_snd_fadeLoopingFixState=LowAPI.Gen_Array([GLLibPlayer.k_snd_nbChannel],0)}for(var g=0;g<GLLibPlayer.k_snd_nbChannel;g++){GLLibPlayer.s_snd_MidiChannelActiveFlags[g]=0;GLLibPlayer.s_snd_fade[(g*GLLibPlayer.k_snd_fade_size)+GLLibPlayer.k_snd_fade_command]=GLLibPlayer.k_snd_fade_command_None;GLLibPlayer.s_snd_fadeTempo[(g*GLLibPlayer.k_snd_fade_size)+GLLibPlayer.k_snd_fade_command]=GLLibPlayer.k_snd_fade_command_None;GLLibPlayer.s_snd_fadeParamsNeedRefresh[g]=false;for(var f=0;f<GLLibPlayer.k_snd_nbMidiChannel;f++){var d=(((g*GLLibPlayer.k_snd_nbMidiChannel)+f)*GLLibPlayer.k_snd_fade_midi_size);GLLibPlayer.s_snd_fadeMidi[d+GLLibPlayer.k_snd_fade_command]=GLLibPlayer.k_snd_fade_command_None;GLLibPlayer.s_snd_fadeMidi[d+GLLibPlayer.k_snd_fade_crt_volume]=GLLibPlayer.k_snd_max_midi_channel_volume}if(GLLibConfig.sound_useFaderLoopingBugFix){GLLibPlayer.s_snd_fadeLoopingFixState[g]=GLLibPlayer.k_snd_fade_loopingfix_state_Normal}}GLLibPlayer.s_snd_fadeDeltaTime=0}for(var g=0;g<GLLibPlayer.k_snd_nbChannel;g++){GLLibPlayer.s_snd_index[g]=-1;GLLibPlayer.s_snd_queue_pointer[g]=0;GLLibPlayer.s_snd_queue_size[g]=0}GLLibPlayer.s_snd_maxNbSoundSlot=e;GLLibPlayer.s_snd_sndSlot=LowAPI.Gen_Array([GLLibPlayer.s_snd_maxNbSoundSlot],null);GLLibPlayer.s_snd_sndType=LowAPI.Gen_Array([GLLibPlayer.s_snd_maxNbSoundSlot],0);if(GLLibConfig.sound_allowURLCreation){GLLibPlayer.s_snd_sndResourceURL=LowAPI.Gen_Array([GLLibPlayer.s_snd_maxNbSoundSlot],null)}if(GLLibConfig.sound_useFakeMediaDuration){GLLibPlayer.s_snd_sndDuration=LowAPI.Gen_Array([GLLibPlayer.s_snd_maxNbSoundSlot],0);GLLibPlayer.s_snd_playTime=LowAPI.Gen_Array([GLLibPlayer.s_snd_maxNbSoundSlot],0)}GLLibPlayer.s_snd_masterVolume=100;GLLibPlayer.s_snd_isSoundEngineInitialized=true};GLLibPlayer.Snd_LoadSound=function(){if(arguments){switch(arguments.length){case 2:return GLLibPlayer._Snd_LoadSound_StringI.apply(this,arguments);case 3:var d=typeof(arguments[0]);if(d=="string"){var f=typeof(arguments[2]);if(f=="number"){return GLLibPlayer._Snd_LoadSound_StringII.apply(this,arguments)}else{return GLLibPlayer._Snd_LoadSound_StringIZ.apply(this,arguments)}}else{var g=typeof(arguments[1]);if(g=="number"){return GLLibPlayer._Snd_LoadSound_ArrayII.apply(this,arguments)}else{return GLLibPlayer._Snd_LoadSound_ArrayStringI.apply(this,arguments)}}break;case 4:var d=typeof(arguments[0]);if(d=="string"){var g=typeof(arguments[1]);if(g=="number"){var f=typeof(arguments[2]);if(f=="number"){return GLLibPlayer._Snd_LoadSound_StringIIZ.apply(this,arguments)}else{return GLLibPlayer._Snd_LoadSound_StringIZI.apply(this,arguments)}}else{return GLLibPlayer._Snd_LoadSound_StringStringIZ.apply(this,arguments)}}else{var g=typeof(arguments[1]);if(g=="number"){return GLLibPlayer._Snd_LoadSound_ArrayIII.apply(this,arguments)}else{var e=typeof(arguments[3]);if(e=="number"){return GLLibPlayer._Snd_LoadSound_ArrayStringII.apply(this,arguments)}else{return GLLibPlayer._Snd_LoadSound_ArrayStringIZ.apply(this,arguments)}}}break;case 5:var d=typeof(arguments[0]);if(d=="string"){var g=typeof(arguments[1]);if(g=="number"){return GLLibPlayer._Snd_LoadSound_StringIIZI.apply(this,arguments)}else{return GLLibPlayer._Snd_LoadSound_StringStringIZI.apply(this,arguments)}}else{var g=typeof(arguments[1]);if(g=="number"){return GLLibPlayer._Snd_LoadSound_ArrayIIZI.apply(this,arguments)}else{return GLLibPlayer._Snd_LoadSound_ArrayStringIZI.apply(this,arguments)}}break}}throw new Error("InvalidArguments")};GLLibPlayer._Snd_LoadSound_StringI=function(d,e){GLLibPlayer.Snd_LoadSound(d,e,GLLibConfig.sound_useCachedPlayers,1)};GLLibPlayer._Snd_LoadSound_StringII=function(d,f,e){GLLibPlayer.Snd_LoadSound(d,f,GLLibConfig.sound_useCachedPlayers,e)};GLLibPlayer._Snd_LoadSound_StringIZ=function(d,e,f){GLLibPlayer.Snd_LoadSound(d,e,f,1)};GLLibPlayer._Snd_LoadSound_StringIZI=function(e,g,h,f){if(!GLLibConfig.sound_enable){return}if(!GLLibPlayer.s_snd_isSoundEngineInitialized){return}if(!((g<GLLibPlayer.s_snd_sndSlot.length))){Assert(false,"resourceIndex is larger that slot count. Read the Warning in the doc.")}if(GLLibConfig.sound_debugVerbose){Dbg("Snd_LoadSound : "+g)}if(g<0){return}if(!(GLLibPlayer.s_snd_sndSlot!=null)){Assert(false,"Snd_LoadSound.snd not correctly initialized")}Pack_Open(e);var d=Pack_ReadData(g);GLLibPlayer.Snd_LoadSound(d,Pack_GetLastDataReadMimeType(),g,h,f)};GLLibPlayer._Snd_LoadSound_ArrayII=function(f,d,e){GLLibPlayer.Snd_LoadSound(f,d,e,GLLibConfig.sound_useCachedPlayers,1)};GLLibPlayer._Snd_LoadSound_ArrayIII=function(f,d,e,g){GLLibPlayer.Snd_LoadSound(f,d,e,GLLibConfig.sound_useCachedPlayers,g)};GLLibPlayer._Snd_LoadSound_ArrayStringI=function(e,f,d){GLLibPlayer.Snd_LoadSound(e,GetMIMEIndex(f,true),d,GLLibConfig.sound_useCachedPlayers,1)};GLLibPlayer._Snd_LoadSound_ArrayStringII=function(e,g,d,f){GLLibPlayer.Snd_LoadSound(e,GetMIMEIndex(g,true),d,GLLibConfig.sound_useCachedPlayers,f)};GLLibPlayer._Snd_LoadSound_ArrayStringIZ=function(e,g,d,f){GLLibPlayer.Snd_LoadSound(e,GetMIMEIndex(g,true),d,f,1)};GLLibPlayer._Snd_LoadSound_ArrayStringIZI=function(e,h,d,g,f){GLLibPlayer.Snd_LoadSound(e,GetMIMEIndex(h,true),d,g,f)};GLLibPlayer._Snd_LoadSound_ArrayIIZI=function(f,d,e,j,h){if(!GLLibConfig.sound_enable||!GLLibPlayer.s_snd_isSoundEngineInitialized){return}if(f==null||f.length<=0){Err("Snd_LoadSound: soundData is null. Sound "+e+" not available.");return}if(!(GLLibConfig.sound_useCachedPlayers||!j)){Assert(false,"Snd_LoadSound: Trying to cache sound but sound_useCachedPlayers is FALSE!")}if(!((e<GLLibPlayer.s_snd_sndSlot.length))){Assert(false,"index is larger that slot count. Read the Warning in the doc.")}if(!(h>=1)){Assert(false,"Snd_LoadSound: count is less than 1.  This will cause errors if GLLibConfig.sound_allowMultiplePlayersPerSlot is true")}GLLibPlayer.s_snd_sndSlot[e]=f;GLLibPlayer.s_snd_sndType[e]=d;if(GLLibConfig.sound_allowMultiplePlayersPerSlot){GLLibPlayer.s_snd_PlayerSlotMultiple[e]=new javax.microedition.media.Player[h];for(var g=0;g<h;g++){if(GLLibConfig.sound_useCachedPlayers&&j){if(GLLibConfig.sound_debugVerbose){Dbg("    create player ("+GetMIME(GLLibPlayer.s_snd_sndType[e])+")")}if(GLLibConfig.sound_useADPCMtoPCMConversion&&GetMIME(GLLibPlayer.s_snd_sndType[e]).compareTo("audio/x-wav")==0){if(SND_CheckWavForADPCMEncoding(GLLibPlayer.s_snd_sndSlot[e])){GLLibPlayer.s_snd_sndSlot[e]=SND_ADPCM_ConvertToPCM(GLLibPlayer.s_snd_sndSlot[e])}}GLLibPlayer.s_snd_PlayerSlotMultiple[e][g]=javax.microedition.media.Manager.createPlayer(new java.io.ByteArrayInputStream(GLLibPlayer.s_snd_sndSlot[e]),GetMIME(GLLibPlayer.s_snd_sndType[e]));if(GLLibConfig.sound_useRealizedPlayers){GLLibPlayer.s_snd_PlayerSlotMultiple[e][g].realize();if(GLLibConfig.sound_usePrefetchedPlayers){GLLibPlayer.s_snd_PlayerSlotMultiple[e][g].prefetch()}}if(g==h-1){GLLibPlayer.s_snd_sndSlot[e]=null}}}}else{if(GLLibConfig.sound_useCachedPlayers&&j){if(GLLibConfig.sound_debugVerbose){Dbg("    create player ("+GetMIME(GLLibPlayer.s_snd_sndType[e])+")")}if(GLLibConfig.sound_useADPCMtoPCMConversion&&GetMIME(GLLibPlayer.s_snd_sndType[e]).compareTo("audio/x-wav")==0){if(SND_CheckWavForADPCMEncoding(GLLibPlayer.s_snd_sndSlot[e])){if(GLLibConfig.sound_debugVerbose){Dbg("Converting ADPCM to PCM")}GLLibPlayer.s_snd_sndSlot[e]=SND_ADPCM_ConvertToPCM(GLLibPlayer.s_snd_sndSlot[e])}}GLLibPlayer.s_snd_PlayerSlot[e]=javax.microedition.media.Manager.createPlayer(new java.io.ByteArrayInputStream(GLLibPlayer.s_snd_sndSlot[e]),GetMIME(GLLibPlayer.s_snd_sndType[e]));if(GLLibConfig.sound_useRealizedPlayers){GLLibPlayer.s_snd_PlayerSlot[e].realize();if(GLLibConfig.sound_usePrefetchedPlayers){GLLibPlayer.s_snd_PlayerSlot[e].prefetch()}}GLLibPlayer.s_snd_sndSlot[e]=null}}if(GLLibConfig.sound_enableProfiling){Profiler_EndNamedEvent()}};GLLibPlayer._Snd_LoadSound_StringStringIZ=function(e,g,d,f){GLLibPlayer.Snd_LoadSound(e,GetMIMEIndex(g,true),d,f,1)};GLLibPlayer._Snd_LoadSound_StringStringIZI=function(e,h,d,g,f){GLLibPlayer.Snd_LoadSound(e,GetMIMEIndex(h,true),d,g,f)};GLLibPlayer._Snd_LoadSound_StringIIZ=function(f,d,e,g){GLLibPlayer.Snd_LoadSound(f,d,e,g,1)};GLLibPlayer._Snd_LoadSound_StringIIZI=function(f,d,e,j,h){if(!GLLibConfig.sound_allowURLCreation){Dbg("Snd_LoadSound(by URL) is not enabled, please set sound_allowURLCreation to TRUE!")}else{if(GLLibConfig.sound_enable&&GLLibPlayer.s_snd_isSoundEngineInitialized){if(GLLibConfig.sound_enableProfiling){Profiler_BeginNamedEvent("Snd_LoadSound")}if(!((e<GLLibPlayer.s_snd_sndSlot.length))){Assert(false,"index is larger that slot count. Read the Warning in the doc.")}if(!(h>=1)){Assert(false,"Snd_LoadSound: count is less than 1.  This will cause errors if GLLibConfig.sound_allowMultiplePlayersPerSlot is true")}GLLibPlayer.s_snd_sndSlot[e]=null;GLLibPlayer.s_snd_sndResourceURL[e]=f;GLLibPlayer.s_snd_sndType[e]=d;if(GLLibConfig.sound_allowMultiplePlayersPerSlot){GLLibPlayer.s_snd_PlayerSlotMultiple[e]=new javax.microedition.media.Player[h];for(var g=0;g<h;g++){if(GLLibConfig.sound_useCachedPlayers&&j){if(GLLibConfig.sound_debugVerbose){Dbg("Snd_LoadSound(by URL) creating player ("+GetMIME(GLLibPlayer.s_snd_sndType[e])+")")}Dbg("Snd_LoadSound(by URL) creating player from URL:"+GLLibPlayer.s_snd_sndResourceURL[e]);GLLibPlayer.s_snd_IgnoreSoundsOnInterrupt=true;GLLibPlayer.s_snd_PlayerSlotMultiple[e][g]=javax.microedition.media.Manager.createPlayer(GLLibPlayer.s_snd_sndResourceURL[e]);GLLibPlayer.s_snd_IgnoreSoundsOnInterrupt=false;if(GLLibConfig.sound_useRealizedPlayers){GLLibPlayer.s_snd_PlayerSlotMultiple[e][g].realize();if(GLLibConfig.sound_usePrefetchedPlayers){GLLibPlayer.s_snd_PlayerSlotMultiple[e][g].prefetch()}}}}}else{if(GLLibConfig.sound_useCachedPlayers&&j){GLLibPlayer.s_snd_IgnoreSoundsOnInterrupt=true;GLLibPlayer.s_snd_PlayerSlot[e]=javax.microedition.media.Manager.createPlayer(GLLibPlayer.s_snd_sndResourceURL[e]);GLLibPlayer.s_snd_IgnoreSoundsOnInterrupt=false;if(GLLibConfig.sound_useRealizedPlayers){GLLibPlayer.s_snd_PlayerSlot[e].realize();if(GLLibConfig.sound_usePrefetchedPlayers){GLLibPlayer.s_snd_PlayerSlot[e].prefetch()}}}}}}};GLLibPlayer.Snd_IsLoaded=function(d){if((GLLibPlayer.s_snd_sndSlot!=null)&&(d<GLLibPlayer.s_snd_sndSlot.length)&&(GLLibPlayer.s_snd_sndSlot[d]!=null)){return true}if(GLLibConfig.sound_allowMultiplePlayersPerSlot){if((GLLibPlayer.s_snd_PlayerSlotMultiple!=null)&&(d<GLLibPlayer.s_snd_PlayerSlotMultiple.length)&&(GLLibPlayer.s_snd_PlayerSlotMultiple[d]!=null)&&(GLLibPlayer.s_snd_PlayerSlotMultiple[d][0]!=null)){return true}}else{if((GLLibPlayer.s_snd_PlayerSlot!=null)&&(d<GLLibPlayer.s_snd_PlayerSlot.length)&&(GLLibPlayer.s_snd_PlayerSlot[d]!=null)){return true}}return false};GLLibPlayer.Snd_Play=function(){if(arguments){switch(arguments.length){case 4:return GLLibPlayer._Snd_Play_IIII.apply(this,arguments);case 5:if(typeof arguments[4]=="number"){return GLLibPlayer._Snd_Play_IIIII.apply(this,arguments)}else{return GLLibPlayer._Snd_Play_IIIIZ.apply(this,arguments)}}}throw new Error("InvalidArguments")};GLLibPlayer._Snd_Play_IIIII=function(h,e,d,g,f){if(GLLibConfig.sound_enableProfiling){Profiler_BeginNamedEvent("Snd_Play")}if(GLLibConfig.sound_enable){if(GLLibConfig.sound_debugVerbose){Dbg("Snd_Play: Channel["+h+"], ID["+e+"], Loop["+d+"], Volume["+g+"] and Priority["+f+"]")}if(!((d>=0))){Assert(false,"Snd_Play: Invalid loop number of "+d)}if(!((h<GLLibPlayer.k_snd_nbChannel))){Assert(false,"Snd_Play: Attempting to play on channel "+h+" while only have max "+GLLibPlayer.k_snd_nbChannel)}if((e<0)||(g==0)){if(GLLibConfig.sound_debugVerbose){Dbg("    dummy sound skipping")}return}GLLibPlayer.SndQueue_Push(h,GLLibPlayer.k_snd_command_play,e,f,g,d)}if(GLLibConfig.sound_enableProfiling){Profiler_EndNamedEvent()}};GLLibPlayer._Snd_Play_IIII=function(e,d,g,f){GLLibPlayer.Snd_Play(e,d,g,f,false)};GLLibPlayer._Snd_Play_IIIIZ=function(e,d,h,f,i){if(GLLibConfig.sound_enableProfiling){Profiler_BeginNamedEvent("Snd_Play")}if(GLLibConfig.sound_enable){var g;g=Snd_GetFreeChannel();if(g==-1){g=Snd_GetLowerPrioChannel(f);if(g==-1){if(!i){if(GLLibConfig.sound_enableProfiling){Profiler_EndNamedEvent()}return}else{g=Snd_GetSamePrioChannel(f);if(g==-1){if(GLLibConfig.sound_enableProfiling){Profiler_EndNamedEvent()}return}}}}if(GLLibConfig.sound_debugVerbose){Dbg("Snd_Play: Channel["+g+"], ID["+e+"], Loop["+d+"], Volume["+h+"] and Priority["+f+"]")}if(!((d>=0))){Assert(false,"Snd_Play: Invalid loop number of "+d)}if(!((g<GLLibPlayer.k_snd_nbChannel))){Assert(false,"Snd_Play: Attempting to play on channel "+g+" while only have max "+GLLibPlayer.k_snd_nbChannel)}if((e<0)||(h==0)){if(GLLibConfig.sound_debugVerbose){Dbg("    dummy sound skipping")}if(GLLibConfig.sound_enableProfiling){Profiler_EndNamedEvent()}return}GLLibPlayer.s_snd_queue_priority[g]=f.castToByte();GLLibPlayer.SndQueue_Push(g,GLLibPlayer.k_snd_command_play,e,f,h,d)}if(GLLibConfig.sound_enableProfiling){Profiler_EndNamedEvent()}};GLLibPlayer.Snd_Stop=function(d,e){var e=e;if(arguments.length<2){e=true}if(!GLLibConfig.sound_enable){return}if(GLLibConfig.sound_enableProfiling){Profiler_BeginNamedEvent("Snd_Stop")}if(GLLibConfig.sound_debugVerbose){Dbg("Snd_stop")}GLLibPlayer.SndQueue_Push(d,GLLibPlayer.k_snd_command_stop);if(GLLibConfig.sound_useFader&&e){Snd_FadeStopChannel(d,true)}if(GLLibConfig.sound_enableProfiling){Profiler_EndNamedEvent()}};GLLibPlayer.Snd_PrepareExec=function(g,e,f){if(!GLLibConfig.sound_enable){return}if((GLLibPlayer.s_snd_state[g]==GLLibPlayer.k_snd_state_playing)&&(GLLibPlayer.s_snd_priority[g]<f)){return}if((GLLibPlayer.s_snd_index[g]==e)&&(GLLibPlayer.s_snd_state[g]!=GLLibPlayer.k_snd_state_unprepared)){return}var d=GLLibPlayer.s_snd_index[g];GLLibPlayer.Snd_FreeChannelExec(g);if(GLLibConfig.sound_useCachedPlayers){GLLibPlayer.s_snd_Player[g]=GLLibPlayer.Snd_GetFreePlayer(e)}if(GLLibConfig.sound_allowURLCreation&&(GLLibPlayer.s_snd_Player[g]==null)&&(GLLibPlayer.s_snd_sndResourceURL[e]!=null)){Dbg("    create player from URL:"+GLLibPlayer.s_snd_sndResourceURL[e]);GLLibPlayer.s_snd_IgnoreSoundsOnInterrupt=true;GLLibPlayer.s_snd_Player[g]=javax.microedition.media.Manager.createPlayer(GLLibPlayer.s_snd_sndResourceURL[e]);GLLibPlayer.s_snd_IgnoreSoundsOnInterrupt=false}if(GLLibPlayer.s_snd_Player[g]==null){if(GLLibPlayer.s_snd_sndSlot[e]==null){return}GLLibPlayer.s_snd_Player[g]=javax.microedition.media.Manager.createPlayer(new java.io.ByteArrayInputStream(GLLibPlayer.s_snd_sndSlot[e]),GetMIME(GLLibPlayer.s_snd_sndType[e]))}if(GLLibPlayer.s_snd_Player[g]==null){return}if(!GLLibConfig.sound_useRealizedPlayers){GLLibPlayer.s_snd_Player[g].realize()}if(!GLLibConfig.sound_usePrefetchedPlayers){GLLibPlayer.s_snd_Player[g].prefetch()}if(GLLibPlayer.s_snd_Player[g].getState()==javax.microedition.media.Player.STARTED){GLLibPlayer.s_snd_Player[g].stop()}GLLibPlayer.s_snd_state[g]=GLLibPlayer.k_snd_state_ready;GLLibPlayer.s_snd_index[g]=e;if(!GLLibConfig.sound_allowMultiplePlayersPerSlot){if(d>=0&&d<GLLibPlayer.s_snd_maxNbSoundSlot){if(GLLibConfig.sound_useCachedPlayers){if(a(d)==javax.microedition.media.Player.STARTED){GLLibPlayer.s_snd_PlayerSlot[d].stop()}}}}};GLLibPlayer.Snd_PlayExec=function(h,e,f,d,g){if(!GLLibConfig.sound_enable||s_game_isPaused){return}GLLibPlayer.Snd_PrepareExec(h,e,f);if(s_game_isPaused){return}if((GLLibPlayer.s_snd_state[h]!=GLLibPlayer.k_snd_state_ready)||(GLLibPlayer.s_snd_Player[h]==null)){return}if(d==0){GLLibPlayer.s_snd_Player[h].setLoopCount(-1)}else{GLLibPlayer.s_snd_Player[h].setLoopCount(d)}if(GLLibConfig.sound_useSetLevel){((GLLibPlayer.s_snd_Player[h].getControl("VolumeControl"))).setLevel(LowAPI.Float2Int((g*GLLibPlayer.s_snd_masterVolume*GLLibPlayer.k_snd_max_volume)/(100*100)))}if(GLLibConfig.sound_useSetMediaTimeBeforePlay){GLLibPlayer.s_snd_Player[h].setMediaTime(0)}GLLibPlayer.s_snd_Player[h].start();GLLibPlayer.s_snd_state[h]=GLLibPlayer.k_snd_state_playing;GLLibPlayer.s_snd_volume[h]=g;GLLibPlayer.s_snd_loop[h]=d;GLLibPlayer.s_snd_priority[h]=f;GLLibPlayer.s_snd_index[h]=e;if(GLLibConfig.sound_useFakeMediaDuration){GLLibPlayer.s_snd_playTime[h]=System.currentTimeMillis()}};GLLibPlayer.Snd_SetMasterVolume=function(e){if(!GLLibConfig.sound_enable){return}if(!GLLibPlayer.s_snd_isSoundEngineInitialized){return}GLLibPlayer.s_snd_masterVolume=e;for(var d=0;d<GLLibPlayer.k_snd_nbChannel;d++){GLLibPlayer.Snd_SetChannelVolume(d,GLLibPlayer.s_snd_volume[d])}};GLLibPlayer.Snd_SetChannelVolume=function(f,d){if(!GLLibConfig.sound_enable||!GLLibPlayer.s_snd_isSoundEngineInitialized||GLLibPlayer.s_snd_Player[f]==null){return}if(GLLibConfig.sound_enableProfiling){Profiler_BeginNamedEvent("Snd_SetChannelVolume")}try{if(GLLibPlayer.s_snd_Player[f]!=null){if(GLLibConfig.sound_useSetLevel){((GLLibPlayer.s_snd_Player[f].getControl("VolumeControl"))).setLevel(LowAPI.Float2Int((d*GLLibPlayer.s_snd_masterVolume*GLLibPlayer.k_snd_max_volume)/(100*100)))}}}catch(g){Err(g)}if(GLLibConfig.sound_enableProfiling){Profiler_EndNamedEvent()}};GLLibPlayer.Snd_StopExec=function(d){if(GLLibConfig.sound_debugVerbose){Dbg("Snd_stopExec")}if(GLLibPlayer.s_snd_Player[d]==null){return}if(GLLibConfig.sound_enableProfiling){Profiler_BeginNamedEvent("Snd_StopExec")}GLLibPlayer.s_snd_Player[d].stop();GLLibPlayer.s_snd_state[d]=GLLibPlayer.k_snd_state_ready;if(GLLibConfig.sound_useFreeChannelOnStop){GLLibPlayer.Snd_FreeChannelExec(d)}if(GLLibConfig.sound_useFakeMediaDuration){GLLibPlayer.s_snd_playTime[d]=0}if(GLLibConfig.sound_enableProfiling){Profiler_EndNamedEvent()}};GLLibPlayer.Snd_Update=function(){GLLibPlayer.Snd_Update_Exec()};GLLibPlayer.Snd_Update_Exec=function(){if(!GLLibConfig.sound_enable||!GLLibPlayer.s_snd_isSoundEngineInitialized){return}for(var d=0;d<GLLibPlayer.k_snd_nbChannel;d++){GLLibPlayer.SndQueue_Pop(d,GLLibPlayer.s_snd_requestBuffer);if(GLLibPlayer.s_snd_requestBuffer[GLLibPlayer.k_snd_queue_size]>0){if(GLLibPlayer.s_snd_state[d]==GLLibPlayer.k_snd_state_playing){var g;try{g=GLLibPlayer.Snd_IsPlaying(d)}catch(f){Dbg("Snd_update.error on channel ("+d+")."+f);g=false}if(!g){GLLibPlayer.s_snd_state[d]=GLLibPlayer.k_snd_state_ready}}while(GLLibPlayer.s_snd_requestBuffer[GLLibPlayer.k_snd_queue_size]>0){switch(GLLibPlayer.s_snd_requestBuffer[GLLibPlayer.k_snd_queue_command]){case GLLibPlayer.k_snd_command_prepare:GLLibPlayer.Snd_PrepareExec(d,GLLibPlayer.s_snd_requestBuffer[GLLibPlayer.k_snd_queue_index],GLLibPlayer.s_snd_requestBuffer[GLLibPlayer.k_snd_queue_priority]);break;case GLLibPlayer.k_snd_command_free:GLLibPlayer.Snd_FreeChannelExec(d);break;case GLLibPlayer.k_snd_command_play:GLLibPlayer.Snd_PlayExec(d,GLLibPlayer.s_snd_requestBuffer[GLLibPlayer.k_snd_queue_index],GLLibPlayer.s_snd_requestBuffer[GLLibPlayer.k_snd_queue_priority],GLLibPlayer.s_snd_requestBuffer[GLLibPlayer.k_snd_queue_loop],GLLibPlayer.s_snd_requestBuffer[GLLibPlayer.k_snd_queue_volume]);break;case GLLibPlayer.k_snd_command_stop:GLLibPlayer.Snd_StopExec(d);break;case GLLibPlayer.k_snd_command_pause:Snd_PauseExec(d);break;case GLLibPlayer.k_snd_command_resume:Snd_ResumeExec(d);break}GLLibPlayer.SndQueue_Pop(d,GLLibPlayer.s_snd_requestBuffer)}}if(GLLibConfig.sound_useFader){SndFade_Update(d)}}};GLLibPlayer.Snd_IsPlaying=function(f){if(!GLLibConfig.sound_enable||!GLLibPlayer.s_snd_isSoundEngineInitialized){return false}if((f>=GLLibPlayer.k_snd_nbChannel)||(GLLibPlayer.s_snd_Player[f]==null)){return false}if(GLLibConfig.sound_enableProfiling){Profiler_BeginNamedEvent("Snd_IsPlaying")}var e=true;if(GLLibConfig.sound_useFakeMediaDuration){var d=Snd_GetCurrentSoundIndex(f);if(d<0){e=false}else{if(GLLibPlayer.s_snd_loop[f]!=0){if((System.currentTimeMillis()-GLLibPlayer.s_snd_playTime[f])>GLLibPlayer.s_snd_sndDuration[d]*GLLibPlayer.s_snd_loop[f]){e=false}}}}else{if(GLLibPlayer.s_snd_Player[f].getState()!=javax.microedition.media.Player.STARTED){e=false}}if(GLLibConfig.sound_enableProfiling){Profiler_EndNamedEvent()}return e};function a(d){if(!GLLibConfig.sound_enable||GLLibConfig.sound_allowMultiplePlayersPerSlot||!GLLibPlayer.s_snd_isSoundEngineInitialized){return -1}if((d<0)||(d>=GLLibPlayer.s_snd_maxNbSoundSlot)||(GLLibPlayer.s_snd_PlayerSlot==null)||(GLLibPlayer.s_snd_PlayerSlot[d]==null)){return -1}var e;e=GLLibPlayer.s_snd_PlayerSlot[d].getState();return e}GLLibPlayer.Snd_FreeChannelExec=function(e){if(!GLLibConfig.sound_enable||!GLLibPlayer.s_snd_isSoundEngineInitialized){return}if(GLLibPlayer.s_snd_Player[e]!=null){GLLibPlayer.s_snd_Player[e].stop();if(!GLLibConfig.sound_usePrefetchedPlayers){GLLibPlayer.s_snd_Player[e].deallocate()}if(!GLLibConfig.sound_useCachedPlayers){GLLibPlayer.s_snd_Player[e].close()}else{var d=GLLibPlayer.s_snd_index[e];if(GLLibConfig.sound_allowMultiplePlayersPerSlot){if(d<0||GLLibPlayer.s_snd_PlayerSlotMultiple[d]==null){GLLibPlayer.s_snd_Player[e].close()}}else{if(d<0||GLLibPlayer.s_snd_PlayerSlot[d]==null){GLLibPlayer.s_snd_Player[e].close()}}}GLLibPlayer.s_snd_Player[e]=null}GLLibPlayer.s_snd_state[e]=GLLibPlayer.k_snd_state_unprepared;GLLibPlayer.s_snd_index[e]=-1};GLLibPlayer.Snd_StopAllSounds=function(){for(var d=0;d<GLLibPlayer.k_snd_nbChannel;d++){GLLibPlayer.Snd_Stop(d)}if(s_game_isPaused==true){GLLibPlayer.Snd_Update_Exec()}};GLLibPlayer.Snd_PauseNotify=function(){if(GLLibConfig.sound_useStopSoundsOnInterrupt&&(!GLLibPlayer.s_snd_IgnoreSoundsOnInterrupt||!GLLibConfig.sound_allowURLCreation)){GLLibPlayer.Snd_StopAllSounds()}}})(GLLibPlayer);