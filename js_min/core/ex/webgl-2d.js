(function(q,k){var v=3.141592653589793;var h=2*v;var u=v/2;function l(x){return x>0&&((x-1)&x)===0}var b={length:function(x){return q.sqrt(x[0]*x[0]+x[1]*x[1]+x[2]*x[2])},normalize:function(x){var y=q.sqrt((x[0]*x[0])+(x[1]*x[1])+(x[2]*x[2]));if(y===0){return[0,0,0]}return[x[0]/y,x[1]/y,x[2]/y]},dot:function(y,x){return y[0]*x[0]+y[1]*x[1]+y[2]*x[2]},angle:function(y,x){return q.acos((y[0]*x[0]+y[1]*x[1]+y[2]*x[2])/(q.sqrt(y[0]*y[0]+y[1]*y[1]+y[2]*y[2])*q.sqrt(x[0]*x[0]+x[1]*x[1]+x[2]*x[2])))},cross:function(y,x){return[y[1]*x[2]-x[1]*y[2],y[2]*x[0]-x[2]*y[0],y[0]*x[1]-x[0]*y[1]]},multiply:function(y,x){return[y[0]*x,y[1]*x,y[2]*x]},add:function(y,x){return[y[0]+x[0],y[1]+x[1],y[2]+x[2]]},subtract:function(y,x){return[y[0]-x[0],y[1]-x[1],y[2]-x[2]]},equal:function(y,x){var z=1e-7;if((y===k)&&(x===k)){return true}if((y===k)||(x===k)){return false}return(q.abs(y[0]-x[0])<z&&q.abs(y[1]-x[1])<z&&q.abs(y[2]-x[2])<z)}};var m={identity:[1,0,0,0,1,0,0,0,1],multiply:function(y,x){var Q=y[0],P=y[1],O=y[2],N=y[3],M=y[4],L=y[5],K=y[6],J=y[7],I=y[8],H=x[0],G=x[1],F=x[2],E=x[3],D=x[4],C=x[5],B=x[6],A=x[7],z=x[8];x[0]=H*Q+E*P+B*O;x[1]=G*Q+D*P+A*O;x[2]=F*Q+C*P+z*O;x[3]=H*N+E*M+B*L;x[4]=G*N+D*M+A*L;x[5]=F*N+C*M+z*L;x[6]=H*K+E*J+B*I;x[7]=G*K+D*J+A*I;x[8]=F*K+C*J+z*I},mat3_multiply:function(y,x){var R=y[0],Q=y[1],P=y[2],O=y[3],N=y[4],M=y[5],L=y[6],K=y[7],J=y[8],I=x[0],G=x[1],F=x[2],E=x[3],D=x[4],C=x[5],B=x[6],A=x[7],z=x[8];var H=[];H[0]=I*R+E*Q+B*P;H[1]=G*R+D*Q+A*P;H[2]=F*R+C*Q+z*P;H[3]=I*O+E*N+B*M;H[4]=G*O+D*N+A*M;H[5]=F*O+C*N+z*M;H[6]=I*L+E*K+B*J;H[7]=G*L+D*K+A*J;H[8]=F*L+C*K+z*J;return H},vec2_multiply:function(z,y){var x=[];x[0]=y[0]*z[0]+y[3]*z[1]+y[6];x[1]=y[1]*z[0]+y[4]*z[1]+y[7];return x},transpose:function(x){return[x[0],x[3],x[6],x[1],x[4],x[7],x[2],x[5],x[8]]}};function s(x){return this.clearStack(x)}var d=16;s.prototype.clearStack=function(x){this.m_stack=[];this.m_cache=[];this.c_stack=0;this.valid=0;this.result=null;for(var y=0;y<d;y++){this.m_stack[y]=this.getIdentity()}if(x!==k){this.m_stack[0]=x}else{this.setIdentity()}};s.prototype.setIdentity=function(){this.m_stack[this.c_stack]=this.getIdentity();if(this.valid===this.c_stack&&this.c_stack){this.valid--}};s.prototype.getIdentity=function(){return[1,0,0,0,1,0,0,0,1]};s.prototype.getResult=function(){if(!this.c_stack){return this.m_stack[0]}var x=m.identity;if(this.valid>this.c_stack-1){this.valid=this.c_stack-1}for(var y=this.valid;y<this.c_stack+1;y++){x=m.multiply(this.m_stack[y],x);this.m_cache[y]=x}this.valid=this.c_stack-1;this.result=this.m_cache[this.c_stack];return this.result};s.prototype.pushMatrix=function(){this.c_stack++;this.m_stack[this.c_stack]=this.getIdentity()};s.prototype.popMatrix=function(){if(this.c_stack===0){return}this.c_stack--};var r=s.prototype.getIdentity();s.prototype.translate=function(z,A){r[6]=z;r[7]=A;m.multiply(r,this.m_stack[this.c_stack])};var j=s.prototype.getIdentity();s.prototype.scale=function(z,A){j[0]=z;j[4]=A;m.multiply(j,this.m_stack[this.c_stack])};var a=s.prototype.getIdentity();s.prototype.rotate=function(x){var y,z;y=q.sin(-x);z=q.cos(-x);a[0]=z;a[3]=y;a[1]=-y;a[4]=z;m.multiply(a,this.m_stack[this.c_stack])};var p=this.WebGL2D=function p(y,x){this.canvas=y;this.options=x||{};this.gl=k;this.fs=k;this.vs=k;this.shaderProgram=k;this.transform=new s();this.shaderPool=[];this.maxTextureSize=k;y.gl2d=this;y.$getContext=y.getContext;y.getContext=(function(z){return function(A){if((z.options.force||A==="webgl-2d")&&!(y.width===0||y.height===0)){if(z.gl){return z.gl}var B=z.gl=z.canvas.$getContext("webgl")||z.canvas.$getContext("experimental-webgl");z.initShaders();z.initShaders(i.texture);z.initShaders(i.texture|i.crop);z.initBuffers();z.initCanvas2DAPI();B.viewport(0,0,z.canvas.width,z.canvas.height);B.enable(B.BLEND);B.blendFuncSeparate(B.SRC_ALPHA,B.ONE_MINUS_SRC_ALPHA,B.ONE,B.ONE_MINUS_SRC_ALPHA);z.maxTextureSize=B.getParameter(B.MAX_TEXTURE_SIZE);return B}else{return z.canvas.$getContext(A)}}}(this));this.postInit()};p.enable=function(y,x){return y.gl2d||new p(y,x)};var i={texture:1,crop:2,};p.prototype.getFragmentShaderSource=function e(y){var x=["#ifdef GL_ES","precision mediump float;","#endif","#define hasTexture "+((y&i.texture)?"1":"0"),"#define hasCrop "+((y&i.crop)?"1":"0"),"varying vec4 vColor;","#if hasTexture","varying vec2 vTextureCoord;","uniform sampler2D uSampler;","#if hasCrop","uniform vec4 uCropSource;","#endif","#endif","void main(void) {","#if hasTexture","#if hasCrop","gl_FragColor = texture2D(uSampler, vec2(vTextureCoord.x * uCropSource.z, vTextureCoord.y * uCropSource.w) + uCropSource.xy);","#else","gl_FragColor = texture2D(uSampler, vTextureCoord);","#endif","#else","gl_FragColor = vColor;","#endif","}"].join("\n");return x};p.prototype.getVertexShaderSource=function g(A){var y=2/this.canvas.width,z=-2/this.canvas.height;var x=["#define hasTexture "+((A&i.texture)?"1":"0"),"attribute vec4 aVertexPosition;","#if hasTexture","varying vec2 vTextureCoord;","#endif","uniform vec4 uColor;","uniform mat3 uTransforms;","varying vec4 vColor;","const mat4 pMatrix = mat4("+y+",0,0,0, 0,"+z+",0,0, 0,0,1.0,1.0, -1.0,1.0,0,0);","void main(void) {","vec3 position = uTransforms * vec3(aVertexPosition.x, aVertexPosition.y, 1.0);","gl_Position = pMatrix * vec4(position, 1.0);","vColor = uColor;","#if hasTexture","vTextureCoord = aVertexPosition.zw;","#endif","}"].join("\n");return x};p.prototype.initShaders=function w(z){var A=this.gl;z=z||0;var y=this.shaderPool[z];if(y){A.useProgram(y);this.shaderProgram=y;return y}else{var x=this.fs=A.createShader(A.FRAGMENT_SHADER);A.shaderSource(this.fs,this.getFragmentShaderSource(z));A.compileShader(this.fs);if(!A.getShaderParameter(this.fs,A.COMPILE_STATUS)){throw"fragment shader error: "+A.getShaderInfoLog(this.fs)}var C=this.vs=A.createShader(A.VERTEX_SHADER);A.shaderSource(this.vs,this.getVertexShaderSource(z));A.compileShader(this.vs);if(!A.getShaderParameter(this.vs,A.COMPILE_STATUS)){throw"vertex shader error: "+A.getShaderInfoLog(this.vs)}var B=this.shaderProgram=A.createProgram();A.attachShader(B,x);A.attachShader(B,C);A.linkProgram(B);if(!A.getProgramParameter(B,A.LINK_STATUS)){throw"Could not initialise shaders."}A.useProgram(B);B.vertexPositionAttribute=A.getAttribLocation(B,"aVertexPosition");A.enableVertexAttribArray(B.vertexPositionAttribute);B.uColor=A.getUniformLocation(B,"uColor");B.uSampler=A.getUniformLocation(B,"uSampler");B.uCropSource=A.getUniformLocation(B,"uCropSource");B.uTransforms=A.getUniformLocation(B,"uTransforms");this.shaderPool[z]=B;return B}};var o;var f;var n=new Float32Array([0,0,0,0,0,1,0,1,1,1,1,1,1,0,1,0]);p.prototype.initBuffers=function t(){var x=this.gl;o=x.createBuffer();f=x.createBuffer();x.bindBuffer(x.ARRAY_BUFFER,o);x.bufferData(x.ARRAY_BUFFER,n,x.STATIC_DRAW)};p.instances=[];p.prototype.postInit=function(){p.instances.push(this)};p.prototype.initCanvas2DAPI=function c(){var T=this,J=this.gl;var X=document.createElement("canvas");X.width=T.canvas.width;X.height=T.canvas.height;var O=X.getContext("2d");var M=/^rgb(a)?\(\s*(-?[\d]+)(%)?\s*,\s*(-?[\d]+)(%)?\s*,\s*(-?[\d]+)(%)?\s*,?\s*(-?[\d\.]+)?\s*\)$/;var aC=/^hsl(a)?\(\s*(-?[\d\.]+)\s*,\s*(-?[\d\.]+)%\s*,\s*(-?[\d\.]+)%\s*,?\s*(-?[\d\.]+)?\s*\)$/;var at=/^#([0-9A-Fa-f]{6})$/;var L=/^#([0-9A-Fa-f])([0-9A-Fa-f])([0-9A-Fa-f])$/;function ai(aJ,aN,aI,aM){var aE,aK,aL,aG,aF;aJ=(((aJ%360)+360)%360)/360;aN=aN>100?1:aN/100;aN=aN<0?0:aN;aI=aI>100?1:aI/100;aI=aI<0?0:aI;if(aN==0){aE=aK=aL=aI}else{function aH(aQ,aP,aO){if(aO<0){aO+=1}if(aO>1){aO-=1}if(aO<1/6){return aQ+(aP-aQ)*6*aO}if(aO<1/2){return aP}if(aO<2/3){return aQ+(aP-aQ)*(2/3-aO)*6}return aQ}aF=aI<0.5?aI*(1+aN):aI+aN-aI*aN;aG=2*aI-aF;aE=aH(aG,aF,aJ+1/3);aK=aH(aG,aF,aJ);aL=aH(aG,aF,aJ-1/3)}return[aE,aK,aL,aM]}function x(aN){var aO=[],aI,aK,aE,aH,aF,aJ;if((aI=M.exec(aN))){aH=aI[1],aF=parseFloat(aI[8]);if((aH&&isNaN(aF))||(!aH&&!isNaN(aF))){return false}aJ=aI[3];for(var aG=2;aG<8;aG+=2){aK=aI[aG],aE=aI[aG+1];if(aE!==aJ){return false}if(aE){aK=aK>100?1:aK/100;aK=aK<0?0:aK}else{aK=aK>255?1:aK/255;aK=aK<0?0:aK}aO.push(aK)}aO.push(aH?aF:1)}else{if((aI=aC.exec(aN))){aH=aI[1],aF=parseFloat(aI[5]);aO=ai(aI[2],aI[3],aI[4],parseFloat(aH&&aF?aF:1))}else{if((aI=at.exec(aN))){var aL=parseInt(aI[1],16);aO=[((aL&16711680)>>16)/255,((aL&65280)>>8)/255,(aL&255)/255,1]}else{if((aI=L.exec(aN))){var aM="#"+[aI[1],aI[1],aI[2],aI[2],aI[3],aI[3]].join("");aO=x(aM)}else{if(aN.toLowerCase() in Z){aO=x(Z[aN.toLowerCase()])}else{if(aN.toLowerCase()==="transparent"){aO=[0,0,0,0]}else{return false}}}}}}return aO}function Q(aE){return"rgba("+(aE[0]*255)+", "+(aE[1]*255)+", "+(aE[2]*255)+", "+parseFloat(aE[3])+")"}var Z={aliceblue:"#f0f8ff",antiquewhite:"#faebd7",aqua:"#00ffff",aquamarine:"#7fffd4",azure:"#f0ffff",beige:"#f5f5dc",bisque:"#ffe4c4",black:"#000000",blanchedalmond:"#ffebcd",blue:"#0000ff",blueviolet:"#8a2be2",brown:"#a52a2a",burlywood:"#deb887",cadetblue:"#5f9ea0",chartreuse:"#7fff00",chocolate:"#d2691e",coral:"#ff7f50",cornflowerblue:"#6495ed",cornsilk:"#fff8dc",crimson:"#dc143c",cyan:"#00ffff",darkblue:"#00008b",darkcyan:"#008b8b",darkgoldenrod:"#b8860b",darkgray:"#a9a9a9",darkgreen:"#006400",darkkhaki:"#bdb76b",darkmagenta:"#8b008b",darkolivegreen:"#556b2f",darkorange:"#ff8c00",darkorchid:"#9932cc",darkred:"#8b0000",darksalmon:"#e9967a",darkseagreen:"#8fbc8f",darkslateblue:"#483d8b",darkslategray:"#2f4f4f",darkturquoise:"#00ced1",darkviolet:"#9400d3",deeppink:"#ff1493",deepskyblue:"#00bfff",dimgray:"#696969",dodgerblue:"#1e90ff",firebrick:"#b22222",floralwhite:"#fffaf0",forestgreen:"#228b22",fuchsia:"#ff00ff",gainsboro:"#dcdcdc",ghostwhite:"#f8f8ff",gold:"#ffd700",goldenrod:"#daa520",gray:"#808080",green:"#008000",greenyellow:"#adff2f",grey:"#808080",honeydew:"#f0fff0",hotpink:"#ff69b4",indianred:"#cd5c5c",indigo:"#4b0082",ivory:"#fffff0",khaki:"#f0e68c",lavender:"#e6e6fa",lavenderblush:"#fff0f5",lawngreen:"#7cfc00",lemonchiffon:"#fffacd",lightblue:"#add8e6",lightcoral:"#f08080",lightcyan:"#e0ffff",lightgoldenrodyellow:"#fafad2",lightgrey:"#d3d3d3",lightgreen:"#90ee90",lightpink:"#ffb6c1",lightsalmon:"#ffa07a",lightseagreen:"#20b2aa",lightskyblue:"#87cefa",lightslategray:"#778899",lightsteelblue:"#b0c4de",lightyellow:"#ffffe0",lime:"#00ff00",limegreen:"#32cd32",linen:"#faf0e6",magenta:"#ff00ff",maroon:"#800000",mediumaquamarine:"#66cdaa",mediumblue:"#0000cd",mediumorchid:"#ba55d3",mediumpurple:"#9370d8",mediumseagreen:"#3cb371",mediumslateblue:"#7b68ee",mediumspringgreen:"#00fa9a",mediumturquoise:"#48d1cc",mediumvioletred:"#c71585",midnightblue:"#191970",mintcream:"#f5fffa",mistyrose:"#ffe4e1",moccasin:"#ffe4b5",navajowhite:"#ffdead",navy:"#000080",oldlace:"#fdf5e6",olive:"#808000",olivedrab:"#6b8e23",orange:"#ffa500",orangered:"#ff4500",orchid:"#da70d6",palegoldenrod:"#eee8aa",palegreen:"#98fb98",paleturquoise:"#afeeee",palevioletred:"#d87093",papayawhip:"#ffefd5",peachpuff:"#ffdab9",peru:"#cd853f",pink:"#ffc0cb",plum:"#dda0dd",powderblue:"#b0e0e6",purple:"#800080",red:"#ff0000",rosybrown:"#bc8f8f",royalblue:"#4169e1",saddlebrown:"#8b4513",salmon:"#fa8072",sandybrown:"#f4a460",seagreen:"#2e8b57",seashell:"#fff5ee",sienna:"#a0522d",silver:"#c0c0c0",skyblue:"#87ceeb",slateblue:"#6a5acd",slategray:"#708090",snow:"#fffafa",springgreen:"#00ff7f",steelblue:"#4682b4",tan:"#d2b48c",teal:"#008080",thistle:"#d8bfd8",tomato:"#ff6347",turquoise:"#40e0d0",violet:"#ee82ee",wheat:"#f5deb3",white:"#ffffff",whitesmoke:"#f5f5f5",yellow:"#ffff00",yellowgreen:"#9acd32"};var aB={},aD=[];function z(aG){var aF={};for(var aE in aG){if(aG.hasOwnProperty(aE)){aF[aE]=aG[aE]}}return aF}function an(){var aE={fillStyle:[aB.fillStyle[0],aB.fillStyle[1],aB.fillStyle[2],aB.fillStyle[3]],strokeStyle:[aB.strokeStyle[0],aB.strokeStyle[1],aB.strokeStyle[2],aB.strokeStyle[3]],globalAlpha:aB.globalAlpha,globalCompositeOperation:aB.globalCompositeOperation,lineCap:aB.lineCap,lineJoin:aB.lineJoin,lineWidth:aB.lineWidth,miterLimit:aB.miterLimit,shadowColor:aB.shadowColor,shadowBlur:aB.shadowBlur,shadowOffsetX:aB.shadowOffsetX,shadowOffsetY:aB.shadowOffsetY,textAlign:aB.textAlign,font:aB.font,textBaseline:aB.textBaseline};aD.push(aE)}function R(){if(aD.length){aB=aD.pop()}}aB.fillStyle=[0,0,0,1];Object.defineProperty(J,"fillStyle",{get:function(){return Q(aB.fillStyle)},set:function(aE){aB.fillStyle=x(aE)||aB.fillStyle}});aB.strokeStyle=[0,0,0,1];Object.defineProperty(J,"strokeStyle",{get:function(){return Q(aB.strokeStyle)},set:function(aE){aB.strokeStyle=x(aE)||aB.strokeStyle}});J.$lineWidth=J.lineWidth;aB.lineWidth=1;Object.defineProperty(J,"lineWidth",{get:function(){return aB.lineWidth},set:function(aE){J.$lineWidth(aE);aB.lineWidth=aE}});aB.lineCap="butt";Object.defineProperty(J,"lineCap",{get:function(){return aB.lineCap},set:function(aE){aB.lineCap=aE}});aB.lineJoin="miter";Object.defineProperty(J,"lineJoin",{get:function(){return aB.lineJoin},set:function(aE){aB.lineJoin=aE}});aB.miterLimit=10;Object.defineProperty(J,"miterLimit",{get:function(){return aB.miterLimit},set:function(aE){aB.miterLimit=aE}});aB.shadowOffsetX=0;Object.defineProperty(J,"shadowOffsetX",{get:function(){return aB.shadowOffsetX},set:function(aE){aB.shadowOffsetX=aE}});aB.shadowOffsetY=0;Object.defineProperty(J,"shadowOffsetY",{get:function(){return aB.shadowOffsetY},set:function(aE){aB.shadowOffsetY=aE}});aB.shadowBlur=0;Object.defineProperty(J,"shadowBlur",{get:function(){return aB.shadowBlur},set:function(aE){aB.shadowBlur=aE}});aB.shadowColor="rgba(0, 0, 0, 0.0)";Object.defineProperty(J,"shadowColor",{get:function(){return aB.shadowColor},set:function(aE){aB.shadowColor=aE}});aB.font="10px sans-serif";Object.defineProperty(J,"font",{get:function(){return aB.font},set:function(aE){O.font=aE;aB.font=aE}});aB.textAlign="start";Object.defineProperty(J,"textAlign",{get:function(){return aB.textAlign},set:function(aE){aB.textAlign=aE}});aB.textBaseline="alphabetic";Object.defineProperty(J,"textBaseline",{get:function(){return aB.textBaseline},set:function(aE){aB.textBaseline=aE}});aB.globalAlpha=1;Object.defineProperty(J,"globalAlpha",{get:function(){return aB.globalAlpha},set:function(aE){aB.globalAlpha=aE}});aB.globalCompositeOperation="source-over";Object.defineProperty(J,"globalCompositeOperation",{get:function(){return aB.globalCompositeOperation},set:function(aE){aB.globalCompositeOperation=aE}});J.fillText=function au(aF,aE,aG){};J.strokeText=function Y(){};J.measureText=function ar(){return 1};var ah=document.createElement("canvas");var ao=ah.getContext("2d");J.save=function U(){T.transform.pushMatrix();an()};J.restore=function W(){T.transform.popMatrix();R()};J.translate=function B(aE,aF){T.transform.translate(aE,aF)};J.rotate=function aA(aE){T.transform.rotate(aE)};J.scale=function aj(aE,aF){T.transform.scale(aE,aF)};J.createImageData=function ag(aF,aE){return ao.createImageData(aF,aE)};J.getImageData=function az(aP,aO,aE,aR){var aI=ao.createImageData(aE,aR);var aG=new Uint8Array(aE*aR*4);J.readPixels(aP,aO,aE,aR,J.RGBA,J.UNSIGNED_BYTE,aG);var aQ=aE*4,aJ=aR;for(var aH=0,aN=aJ/2;aH<aN;++aH){for(var aF=0,aM=aQ;aF<aM;++aF){var aL=aH*aQ+aF;var aK=(aJ-aH-1)*aQ+aF;aI.data[aL]=aG[aK];aI.data[aK]=aG[aL]}}return aI};J.putImageData=function ap(aG,aE,aF){J.drawImage(aG,aE,aF)};J.transform=function ad(aI,aH,aK,aJ,aG,aF){var aE=T.transform.m_stack[T.transform.c_stack];aE[0]*=aI;aE[1]*=aK;aE[2]*=aG;aE[3]*=aH;aE[4]*=aJ;aE[5]*=aF;aE[6]=0;aE[7]=0};function D(aI){var aE=T.transform.m_stack;var aH=aE[0];for(var aG=0,aF=T.transform.c_stack+1;aG<aF;++aG){aH=m.mat3_multiply(aH,aE[aF-1-aG])}J.uniformMatrix3fv(aI.uTransforms,false,aH)}J.setTransform=function C(aH,aG,aJ,aI,aF,aE){T.transform.setIdentity();J.transform.apply(this,arguments)};J.fillRect=function aw(aF,aJ,aH,aE){var aG=T.transform;var aI=T.initShaders(0);J.bindBuffer(J.ARRAY_BUFFER,o);J.vertexAttribPointer(aI.vertexPositionAttribute,4,J.FLOAT,false,0,0);aG.pushMatrix();aG.translate(aF,aJ);aG.scale(aH,aE);D(aI);J.uniform4f(aI.uColor,aB.fillStyle[0],aB.fillStyle[1],aB.fillStyle[2],aB.fillStyle[3]);J.drawArrays(J.TRIANGLE_FAN,0,4);aG.popMatrix()};J.strokeRect=function aa(aF,aJ,aH,aE){var aG=T.transform;var aI=T.initShaders(0);J.bindBuffer(J.ARRAY_BUFFER,o);J.vertexAttribPointer(aI.vertexPositionAttribute,4,J.FLOAT,false,0,0);aG.pushMatrix();aG.translate(aF,aJ);aG.scale(aH,aE);D(aI);J.uniform4f(aI.uColor,aB.strokeStyle[0],aB.strokeStyle[1],aB.strokeStyle[2],aB.strokeStyle[3]);J.drawArrays(J.LINE_LOOP,0,4);aG.popMatrix()};J.clearRect=function E(aF,aH,aG,aE){};var G=[];function V(aE,aF){this.closed=false;this.verts=[aE,aF,0,0]}J.beginPath=function al(){G.length=0};J.closePath=function K(){if(G.length){var aG=G[G.length-1],aF=aG.verts[0],aE=aG.verts[1];aG.closed=true;var aH=new V(aF,aE);G.push(aH)}};J.moveTo=function y(aE,aF){G.push(new V(aE,aF))};J.lineTo=function ay(aE,aF){if(G.length){G[G.length-1].verts.push(aE,aF,0,0)}else{J.moveTo(aE,aF)}};J.quadraticCurveTo=function ax(aG,aF,aE,aH){};J.bezierCurveTo=function ak(aG,aF,aI,aH,aE,aJ){};J.arcTo=function F(){};J.rect=function af(aE,aH,aF,aG){J.moveTo(aE,aH);J.lineTo(aE+aF,aH);J.lineTo(aE+aF,aH+aG);J.lineTo(aE,aH+aG);J.closePath()};J.arc=function ab(aF,aJ,aE,aH,aG,aI){};function I(aG){var aF=T.transform;var aI=T.initShaders(0);var aE=G[aG];var aH=aE.verts;J.bindBuffer(J.ARRAY_BUFFER,f);J.bufferData(J.ARRAY_BUFFER,new Float32Array(aH),J.STATIC_DRAW);J.vertexAttribPointer(aI.vertexPositionAttribute,4,J.FLOAT,false,0,0);aF.pushMatrix();D(aI);J.uniform4f(aI.uColor,aB.fillStyle[0],aB.fillStyle[1],aB.fillStyle[2],aB.fillStyle[3]);J.drawArrays(J.TRIANGLE_FAN,0,aH.length/4);aF.popMatrix()}J.fill=function P(){for(var aE=0;aE<G.length;aE++){I(aE)}};function av(aG){var aF=T.transform;var aI=T.initShaders(0);var aE=G[aG];var aH=aE.verts;J.bindBuffer(J.ARRAY_BUFFER,f);J.bufferData(J.ARRAY_BUFFER,new Float32Array(aH),J.STATIC_DRAW);J.vertexAttribPointer(aI.vertexPositionAttribute,4,J.FLOAT,false,0,0);aF.pushMatrix();D(aI);J.uniform4f(aI.uColor,aB.strokeStyle[0],aB.strokeStyle[1],aB.strokeStyle[2],aB.strokeStyle[3]);if(aE.closed){J.drawArrays(J.LINE_LOOP,0,aH.length/4)}else{J.drawArrays(J.LINE_STRIP,0,aH.length/4)}aF.popMatrix()}J.stroke=function ae(){for(var aE=0;aE<G.length;aE++){av(aE)}};J.clip=function am(){};J.isPointInPath=function S(){};J.drawFocusRing=function aq(){};var H=[],ac=[];function N(aI,aG){if(aI.width>T.maxTextureSize||aI.height>T.maxTextureSize){throw new Error("the texture size is too large!")}this.obj=aG!=k?aG.obj:J.createTexture();this.width=aI.width;this.height=aI.height;J.bindTexture(J.TEXTURE_2D,this.obj);J.pixelStorei(J.UNPACK_PREMULTIPLY_ALPHA_WEBGL,true);J.texImage2D(J.TEXTURE_2D,0,J.RGBA,J.RGBA,J.UNSIGNED_BYTE,aI);var aF=J.RGBA;var aN=J.RGBA;var aM=J.UNSIGNED_BYTE;var aP;var aJ=l(aI.width)&&l(aI.height);if(aJ){aP=false}var aK;var aL=false;if(aL){aK=null}var aE=true;if(!aJ&&aL){var aH=document.createElement("canvas");aH.width=LowAPI.nextHighestPowerOfTwo(aI.width);aH.height=LowAPI.nextHighestPowerOfTwo(aI.height);var aO=aH.getContext("2d");aO.webkitImageSmoothingEnabled=aE;aO.mozImageSmoothingEnabled=aE;aO.msImageSmoothingEnabled=aE;aO.imageSmoothingEnabled=aE;aO.drawImage(aI,0,0,aI.width,aI.height,0,0,aH.width,aH.height);J.texImage2D(J.TEXTURE_2D,0,aF,aN,aM,aH)}else{J.texImage2D(J.TEXTURE_2D,0,aF,aN,aM,aI)}if(aL){if(aK==="repeat-x"){J.texParameteri(J.TEXTURE_2D,J.TEXTURE_WRAP_S,J.REPEAT);J.texParameteri(J.TEXTURE_2D,J.TEXTURE_WRAP_T,J.CLAMP_TO_EDGE)}else{if(aK==="repeat-y"){J.texParameteri(J.TEXTURE_2D,J.TEXTURE_WRAP_S,J.CLAMP_TO_EDGE);J.texParameteri(J.TEXTURE_2D,J.TEXTURE_WRAP_T,J.REPEAT)}else{J.texParameteri(J.TEXTURE_2D,J.TEXTURE_WRAP_S,J.REPEAT);J.texParameteri(J.TEXTURE_2D,J.TEXTURE_WRAP_T,J.REPEAT)}}}else{J.texParameteri(J.TEXTURE_2D,J.TEXTURE_WRAP_S,J.CLAMP_TO_EDGE);J.texParameteri(J.TEXTURE_2D,J.TEXTURE_WRAP_T,J.CLAMP_TO_EDGE)}if(aE){J.texParameteri(J.TEXTURE_2D,J.TEXTURE_MAG_FILTER,J.LINEAR);if(aJ&&aP){J.texParameteri(J.TEXTURE_2D,J.TEXTURE_MIN_FILTER,J.LINEAR_MIPMAP_LINEAR);J.generateMipmap(J.TEXTURE_2D)}else{J.texParameteri(J.TEXTURE_2D,J.TEXTURE_MIN_FILTER,J.LINEAR)}}else{J.texParameteri(J.TEXTURE_2D,J.TEXTURE_MAG_FILTER,J.NEAREST);J.texParameteri(J.TEXTURE_2D,J.TEXTURE_MIN_FILTER,J.NEAREST)}J.bindTexture(J.TEXTURE_2D,null)}J.cacheAsTexture=function(aF,aE){return new N(aF,aE)};J.drawImage=function A(aG,aQ,aP,aO,aN,aL,aK,aJ,aI){var aF=T.transform;aF.pushMatrix();var aH=i.texture;var aR=false;var aM;if(aG instanceof N){aM=aG}else{throw new Error("OPT performance: Please cache this image before!")}if(aO==k){aF.translate(aQ,aP);aF.scale(aG.width,aG.height)}else{if(aL==k){aF.translate(aQ,aP);aF.scale(aO,aN)}else{aF.translate(aL,aK);aF.scale(aJ,aI);if(aQ!=0||aP!=0||aO!=aG.width||aN!=aG.height){aH=aH|i.crop;aR=true}}}var aE=T.initShaders(aH);if(aR){J.uniform4f(aE.uCropSource,(aQ+0.25)/aG.width,(aP+0.25)/aG.height,(aO-0.5)/aG.width,(aN-0.5)/aG.height)}J.bindBuffer(J.ARRAY_BUFFER,o);J.vertexAttribPointer(aE.vertexPositionAttribute,4,J.FLOAT,false,0,0);J.bindTexture(J.TEXTURE_2D,aM.obj);J.activeTexture(J.TEXTURE0);J.uniform1i(aE.uSampler,0);D(aE);J.drawArrays(J.TRIANGLE_FAN,0,4);aF.popMatrix()}}}(Math));