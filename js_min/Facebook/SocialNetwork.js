(function(a,c){var b=function(d){this.m_infos=d;this.m_img=null;this.m_isImgLoading=false};b.prototype.getName=function(){return this.m_infos.name};b.prototype.getUserName=function(){throw new Error("Not implemented yet!")};b.prototype.getFirstName=function(){throw new Error("Not implemented yet!")};b.prototype.getLastName=function(){throw new Error("Not implemented yet!")};b.prototype.getMiddleName=function(){throw new Error("Not implemented yet!")};b.prototype.getId=function(){return this.m_infos.id};b.prototype.getPhoto=function(){throw new Error("Not implemented yet!")};b.prototype.getImage=function(){try{if(this.m_img==null&&!this.m_isImgLoading){var g=this;g.m_isImgLoading=true;var d;if(g.m_infos.picture){d=g.m_infos.picture["data"]["url"];var f=new XMLHttpRequest();f.open("GET",d,true);f.onreadystatechange=function(){if(f.readyState===XMLHttpRequest.DONE&&f.status===200){Midp2Image.decodeImageData(f.response,0,f.response.byteLength,function(i){var j=Midp2Image.createImage(SocialNetwork.m_pictureWidth,SocialNetwork.m_pictureHeight);j.m_HTMLCanvasElement.getContext("2d").drawImage(i,0,0,i.width,i.height,0,0,SocialNetwork.m_pictureWidth,SocialNetwork.m_pictureHeight);var e=new Image(j);j.cacheAsTexture();g.m_img=e;g.m_isImgLoading=false})}};f.responseType="arraybuffer";f.send(null)}else{FB.api("/"+g.m_infos.id+"/picture",function(i){if(i&&!i.error){g.m_infos.picture=[];g.m_infos.picture["data"]=[];g.m_infos.picture["data"]["url"]=i.data["url"];d=g.m_infos.picture["data"]["url"];var e=new XMLHttpRequest();e.open("GET",d,true);e.onreadystatechange=function(){if(e.readyState===XMLHttpRequest.DONE&&e.status===200){Midp2Image.decodeImageData(e.response,0,e.response.byteLength,function(k){var l=Midp2Image.createImage(SocialNetwork.m_pictureWidth,SocialNetwork.m_pictureHeight);l.m_HTMLCanvasElement.getContext("2d").drawImage(k,0,0,k.width,k.height,0,0,SocialNetwork.m_pictureWidth,SocialNetwork.m_pictureHeight);var j=new Image(l);l.cacheAsTexture();g.m_img=j;g.m_isImgLoading=false})}};e.responseType="arraybuffer";e.send(null)}})}}}catch(h){Warn(h)}return this.m_img};b.prototype.getPhotoPath=function(){throw new Error("Not implemented yet!")};b.prototype.getInstalled=function(){var d=!!this.m_infos.installed;return d};b.prototype.getCountry=function(){throw new Error("Not implemented yet!")};b.prototype.getScore=function(){throw new Error("Not implemented yet!")};a.GraphUser=b})(window);(function(g,f){(function(o,l,p){var n,m=o.getElementsByTagName(l)[0];if(o.getElementById(p)){return}n=o.createElement(l);n.id=p;n.src="//connect.facebook.net/en_US/sdk.js";m.parentNode.insertBefore(n,m)}(document,"script","facebook-jssdk"));var j={};j.m_pictureWidth=50;j.m_pictureHeight=50;var b=null;var e=null;var c=null;var d=false;var a=false;var i=null;var h=function(l){b=l;if(!d){if(l.status==="connected"){d=true}}};function k(l){FB.init({appId:l,status:true,cookie:true,oauth:true,xfbml:false,version:"v2.8"});FB.Event.subscribe("auth.login",function(m){if(!m.authResponse){return}d=true;h()});FB.getLoginStatus(function(m){if(m.authResponse){d=true;h()}})}j.setApplication=function(l,m){if(window.FB!=f){k(l)}else{window.fbAsyncInit=function(){k(l)}}};j.setPhoto=function(m,l){j.m_pictureWidth=m;j.m_pictureHeight=l};j.isLoggedIn=function(){return d};j.Login=function(){b=null;FB.getLoginStatus(function(l){if(l.status==="connected"){h(l)}else{if(!Device.isWindowsPhone&&!Device.isHuaweiG6){FB.login(function(n){h(n)},{scope:"public_profile,email,user_friends,read_custom_friendlists,publish_actions",return_scopes:true})}else{var m=window.location;window.location="https://www.facebook.com/v2.9/dialog/oauth?client_id="+fbm_FacebookAppId()+"&redirect_uri="+m}}})};j.Logout=function(){FB.logout(function(l){d=false;i=null;e=null})};j.LoadData=function(){a=false;var l="name,first_name,last_name,picture,installed";FB.api("/me",{fields:l},function(m){i=new GraphUser(m);e=null;FB.api("/"+i.getId()+"/friends",{fields:l},function(n){if(n&&!n.error){e=[];var p=n.data;for(var o=0;o<p.length;o++){e.push(new GraphUser(p[o]))}a=true}})})};j.isDataReady=function(){return a};j.getUser=function(){return i};j.getFriends=function(){return e};j.getWorldPlayer=function(){return c};j.addWorldPlayer=function(l){if(c==null){c=[]}c.push(l)};j.isWorldPlayerExits=function(m){if(c==null){return false}for(var l=0;l<c.length;l++){if(c[l].m_infos.id==m){return true}}return false};j.isFriendExits=function(m){if(e==null){return false}for(var l=0;l<e.length;l++){if(e[l].m_infos.id==m){return true}}return false};j.getPassword=function(){if(b&&b.authResponse&&b.authResponse["accessToken"]){return b.authResponse["accessToken"]}else{return""}};j.postToWall=function(u,q,l,s,r,p,o,n,t){var m={method:"feed",message:u,link:q,name:l,caption:s,description:r};if(p.length){m.picture=p}FB.ui(m,function(v){if(!v||v.error){onPostedStatus(2,v.error)}else{onPostedStatus(0)}})};j.InviteByDialog=function(n,l){var m=l;FB.ui({method:"apprequests",message:n},function(o){if(m){if(!o||o.error){m(2,o.error)}else{if(o&&o.request){m(0,"success")}else{m(1,"cancel")}}}})};j.PublishScore=function(l,m,n){if(!d){return}FB.api("/"+i.getId()+"/scores","POST",{score:Math.floor(l),access_token:m+"|"+n},function(o){if(!o||o.error){console.error(o)}else{console.log(o)}})};j.RequestUserHiscore=function(n){if(!d){return}var m=0;var l=n;FB.api("/"+i.getId()+"/scores",function(q){var p=q.data;if(!p){console.error("Request for user hi-score failed: "+q);return}var r,o;for(r=0,o=p.length;r<o;r++){if(p[r]["score"]>m){m=p[r]["score"]}}if(!q||q.error){l(false);console.log("errorrrrrrrrrrrrr")}else{l(m);console.log(q.data)}})};j.RequestHiscores=function(q,t,p){if(!d){return}var o=p;var r=0;var m="";var l=0;var s=0;FB.api("/"+q+"/scores","GET",{},function(w){var u=w.data;if(!u){console.error("Hi-scores request failed: "+w);return}u.sort(function(A,z){return z.score-A.score});var x=0,n=Math.min(u.length,t);var v=[];v.total_entries=n;v.data=[];for(;x<n;x++){r=u[x]["score"];m=u[x]["user"]["name"];l=u[x]["user"]["id"];s=x+1;var y={rank:s,score:r,credential:l,display_name:m,"char":"0",};v.data.push(y)}if(!w||w.error){o(false);console.error(w)}else{o(v);console.log(w)}})};g.SocialNetwork=j})(window);