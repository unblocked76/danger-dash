(function(a){var c=1000;var b=500;var e=1200;function d(){this.__cParticle__initialization__();this.contructor()}d.PARTICLE_TYPE_NONE=0;d.PARTICLE_TYPE_SPARKS=1;d.PARTICLE_TYPE_SPEED_LINE=2;d.PARTICLE_TYPE_COLLISION=3;d.PARTICLE_TYPE_BONUS=4;d.PARTICLE_TYPE_LANDING_SPARKS=5;d.PARTICLE_TYPE_ENGINE_SMOKE=6;d.PARTICLE_TYPE_LINE_SPARKS=7;d.PARTICLE_TYPE_TEXTURE_DESTROY=8;d.PARTICLE_TYPE_WATERFALL_LEFT=9;d.PARTICLE_TYPE_WATERFALL_RIGHT=10;d.PARTICLE_TYPE_FIREWORKS=11;d.PARTICLE_TYPE_IMAGE_DESTROY=12;d.PARTICLE_TYPE_CURSOR_LEFT=13;d.PARTICLE_TYPE_CURSOR_RIGHT=14;d.PARTICLE_TYPE_SPLASH_DESTROY=15;d.PARTICLE_TYPE_SNOW=16;d.PARTICLE_TYPE_CONFETTI=19;d.PARTICLE_IMAGE_DESTROY_TYPE1=1;d.PARTICLE_IMAGE_DESTROY_TYPE2=2;d.PARTICLE_SPARKS_LIFE=1000;d.PARTICLE_SPARKS_SPEED_MIN=7;d.PARTICLE_SPARKS_SPEED_MAX=20;d.PARTICLE_SPARKS_LENGHT=12;d.PARTICLE_LINE_SPARKS_LENGHT=8;d.PARTICLE_LINE_SPARKS_MAX_ANGLE=20;d.PARTICLE_LINE_SPARKS_ANGLE=Math_DegreeToFixedPointAngle(10);d.PARTICLE_LINE_SPARKS_LIFE=1000;d.PARTICLE_LINE_SPARKS_SPEED_MIN=8;d.PARTICLE_LINE_SPARKS_SPEED_MAX=15;d.PARTICLE_SIDE_UP=0;d.PARTICLE_SIDE_RIGHT=1;d.PARTICLE_SIDE_DOWN=2;d.PARTICLE_SIDE_LEFT=3;d.PARTICLE_MAX_HEIGHT=2;d.PARTICLE_SPARKS_MAX_ANGLE=35;d.PARTICLE_SPARKS_ANGLE=Math_DegreeToFixedPointAngle(22);d.PARTICLE_COLLISION_MAX_ANGLE=30;d.PARTICLE_COLLISION_ANGLE=Math_DegreeToFixedPointAngle(60);d.PARTICLE_BONUS_MAX_ANGLE=90;d.PARTICLE_BONUS_ANGLE=Math_DegreeToFixedPointAngle(90);d.PARTICLE_LANDING_SPARKS_SPEED_MIN=8;d.PARTICLE_LANDING_SPARKS_SPEED_MAX=15;d.PARTICLE_LANDING_SPARCLES_MAX_ANGLE=40;d.PARTICLE_LANDING_SPARKS_ANGLE=Math_DegreeToFixedPointAngle(15);d.PARTICLE_ENGINE_SMOKE_MAX_ANGLE=15;d.k_engine_smoke_grow_interval=Math_fixedPointTime(100);d.k_horizontal_smoke_start_speed=40;d.PARTICLE_CONFETTI_ROTATE_PERIOD=Math_fixedPointTime(500);d.PARTICLE_CONFETTI_SIZE=12;d.PARTICLE_CONFETTI_SPEED_REDUCTION_TIME=Math_fixedPointTime(500);d.PARTICLE_CONFETTI_DIRECTION_CHANGE_TIME=Math_fixedPointTime(1200);d.PARTICLE_CONFETTI_SCREEN_EDGE_SIZE=10;d.PARTICLE_CONFETTI_ROTATE_TYPE_CHANGE_TIME=Math_fixedPointTime(2000);d.showSpecial=false;d.prototype.__cParticle__initialization__=function(){this.mSegment=0;this.mKey=0;this.xPos=0;this.yPos=0;this.xPosInit=0;this.yPosInit=0;this.mType=0;this.mLife=0;this.mSpeed=0;this.mSpeedInit=0;this.mAngle=0;this.mLength=0;this.mColor=0;this.mHeight=0;this.mZoom=0;this.mStep=0;this.mNrStep=0;this.mLifeDim=0;this.mCoefficient=0;this.mWeight=0;this.mImageArray=null;this.t=0;this.xOffset=0;this.yOffset=0};d.prototype.isAlive=function(){if(this.mType==d.PARTICLE_TYPE_SPEED_LINE&&this.yPos<70){return false}if((this.mType==d.PARTICLE_TYPE_WATERFALL_LEFT||this.mType==d.PARTICLE_TYPE_WATERFALL_RIGHT||this.mType==d.PARTICLE_TYPE_FIREWORKS||this.mType==d.PARTICLE_TYPE_CURSOR_LEFT||this.mType==d.PARTICLE_TYPE_CURSOR_RIGHT)&&this.mLife>=0){return true}if(this.mType==d.PARTICLE_TYPE_CONFETTI){if(this.mLife>=0&&this.xPos>=-d.PARTICLE_CONFETTI_SCREEN_EDGE_SIZE&&this.xPos<=s_screenWidth+d.PARTICLE_CONFETTI_SCREEN_EDGE_SIZE&&this.yPos<=s_screenHeight){return true}}if(this.mLife>=0&&this.xPos>=0&&this.xPos<=s_screenWidth&&this.yPos>=0&&this.yPos<=s_screenHeight){return true}return false};d.prototype.updateParticle=function(h){var i=Math_FixedPoint_Subtract(Math_Angle90,Math_Abs(this.mAngle));this.xPos+=LowAPI.Float2Int(this.SGN(this.mAngle)*Math_FixedPointToInt((Math_Cos(i)*this.mSpeed))*h/BuildConf.k_static_dt_value);switch(this.mType){case d.PARTICLE_TYPE_SPEED_LINE:this.yPos+=LowAPI.Float2Int(((Math_FixedPointToInt(Math_Sin(i)*this.mSpeed)*h/BuildConf.k_static_dt_value)*3)/4);this.mSpeed+=LowAPI.Float2Int(h/20);break;case d.PARTICLE_TYPE_COLLISION:this.yPos+=LowAPI.Float2Int(Math_FixedPointToInt(Math_Sin(i)*this.mSpeed)*h/BuildConf.k_static_dt_value);this.mLife-=h;if(this.mNrStep==1){this.mAngle+=LowAPI.Float2Int(this.mLength*h/BuildConf.k_static_dt_value)}else{this.mAngle-=LowAPI.Float2Int(this.mLength*h/BuildConf.k_static_dt_value)}break;case d.PARTICLE_TYPE_ENGINE_SMOKE:this.yPos+=LowAPI.Float2Int(Math_FixedPointToInt(Math_Sin(i)*this.mSpeed)*h/BuildConf.k_static_dt_value);this.mLife-=h;this.mLifeDim+=h;if(this.mHeight<this.mImageArray.length-1){this.mHeight=LowAPI.Float2Int(this.mLifeDim/d.k_engine_smoke_grow_interval).castToByte();if(this.mHeight>this.mImageArray.length-1){this.mHeight=(this.mImageArray.length-1).castToByte()}if(this.mSpeed<0&&this.mHeight>1){this.mHeight=1}}break;case d.PARTICLE_TYPE_BONUS:this.yPos+=LowAPI.Float2Int(Math_FixedPointToInt(Math_Sin(i)*this.mSpeed)*h/BuildConf.k_static_dt_value);this.mLife-=h;if(this.mNrStep==1){this.mAngle+=LowAPI.Float2Int(this.mLength*h/BuildConf.k_static_dt_value)}else{this.mAngle-=LowAPI.Float2Int(this.mLength*h/BuildConf.k_static_dt_value)}break;case d.PARTICLE_TYPE_LANDING_SPARKS:this.yPos+=LowAPI.Float2Int(Math_FixedPointToInt(Math_Sin(i)*this.mSpeed)*h/BuildConf.k_static_dt_value);this.mLife-=h;break;case d.PARTICLE_TYPE_SPARKS:this.yPos+=LowAPI.Float2Int(Math_FixedPointToInt(Math_Sin(i)*this.mSpeed)*h/BuildConf.k_static_dt_value);this.mLength+=LowAPI.Float2Int(h/20);this.mStep=((this.mStep+1)%this.mNrStep).castToByte();if(this.mStep==0){this.mHeight+=1}break;case d.PARTICLE_TYPE_LINE_SPARKS:this.yPos+=LowAPI.Float2Int(Math_FixedPointToInt(Math_Sin(i)*this.mSpeed)*h/BuildConf.k_static_dt_value);this.mLength++;break;case d.PARTICLE_TYPE_TEXTURE_DESTROY:this.yPos+=LowAPI.Float2Int(Math_FixedPointToInt(Math_Sin(i)*this.mSpeed)*h/BuildConf.k_static_dt_value);this.mLife-=h;if(this.mNrStep==1){this.mAngle+=this.mLength}else{this.mAngle-=this.mLength}break;case d.PARTICLE_TYPE_WATERFALL_LEFT:case d.PARTICLE_TYPE_WATERFALL_RIGHT:this.t+=this.mSpeed;this.yPos=this.t;this.xPos=Math_Sqrt(this.yPos*this.mCoefficient)*this.mAngle;if(this.yPos>100){killParticle()}break;case d.PARTICLE_TYPE_FIREWORKS:this.yPos-=LowAPI.Float2Int(Math_FixedPointToInt(Math_Sin(i)*this.mSpeed)*h/BuildConf.k_static_dt_value);if(this.mLife<=LowAPI.Float2Int(this.mLifeDim/2)){if(this.mSpeed-2<=0&&this.mSpeed>0){this.mAngle=0}if(this.mSpeed>-3){this.mSpeed-=2}if(this.mSpeed<0){if(this.mHeight>0){this.mHeight--}else{killParticle()}}}this.mLife-=h;break;case d.PARTICLE_TYPE_IMAGE_DESTROY:this.mLife-=h;this.mLifeDim+=h;if(LowAPI.Float2Int(this.mLife/2)<this.mLifeDim){this.yPos-=LowAPI.Float2Int(Math_FixedPointToInt(Math_Sin(i)*this.mSpeed)*h/BuildConf.k_static_dt_value);if(this.mHeight>1){this.mHeight--}else{killParticle()}if(this.mNrStep!=0){if(this.mNrStep==1){this.mAngle+=this.mLength}else{this.mAngle-=this.mLength}}}else{this.xPos=xPosInit}break;case d.PARTICLE_TYPE_CURSOR_LEFT:case d.PARTICLE_TYPE_CURSOR_RIGHT:var j=e+c;var f=LowAPI.Float2Int((127*this.mLifeDim)/j+127);var k=GetValueBetweenPointsByTime(f,0,this.mLifeDim-this.mLife,this.mLifeDim,false);this.mColor=k<<24|(this.mColor&16777215);this.xPos+=this.mSpeed;this.mLife-=h;break;case d.PARTICLE_TYPE_SPLASH_DESTROY:this.yPos-=LowAPI.Float2Int(Math_FixedPointToInt(Math_Sin(i)*this.mSpeed)*h/BuildConf.k_static_dt_value);this.mLife-=h;this.mHeight--;if(this.mHeight==0){killParticle()}if(this.mNrStep==1){this.mAngle+=this.mLength}else{this.mAngle-=this.mLength}break;case d.PARTICLE_TYPE_SNOW:this.yPos+=Math_FixedPointToInt(Math_Sin(i)*this.mSpeed);this.mLife-=h;var l=MPS_2_KMH(s_player._speed);this.mLength-=LowAPI.Float2Int(l*h/8000);this.mHeight=LowAPI.Float2Int(4-this.mLength/10).castToByte();var n=LowAPI.Float2Int(this.xPos-s_screenWidth/2);var m=this.yPos-s_viewProjCenter+50;var g=0;this.xPos+=LowAPI.Float2Int((Math_FixedPointToInt(l*this.mHeight*Math_Cos(g)))*h/30000);this.yPos+=LowAPI.Float2Int(Math_FixedPointToInt(l*this.mHeight*Math_Sin(g))*h/70000);if(this.mHeight>3){this.mHeight=3}break;case d.PARTICLE_TYPE_CONFETTI:this.yPos-=LowAPI.Float2Int(Math_FixedPointToInt(Math_Sin(i)*this.mSpeed)*h/BuildConf.k_static_dt_value);this.yPos+=LowAPI.Float2Int(this.mWeight*h/BuildConf.k_static_dt_value);this.mLife-=h;this.mCoefficient+=h;if(this.mCoefficient>d.PARTICLE_CONFETTI_SPEED_REDUCTION_TIME){this.mSpeed=2;if(this.mLife%this.mLength<this.mLength>>2||this.mLife%this.mLength>this.mLength-(this.mLength>>2)){this.mSpeed=1}this.mAngle=Math_DegreeToFixedPointAngle((LowAPI.Float2Int(this.mLife/this.mLength)%2==0)?85:-85)}else{this.mSpeed=LowAPI.Float2Int(this.mSpeedInit*(d.PARTICLE_CONFETTI_SPEED_REDUCTION_TIME-this.mCoefficient)/d.PARTICLE_CONFETTI_SPEED_REDUCTION_TIME)}this.mNrStep=LowAPI.Float2Int((this.mLife/this.mLength)%2).castToByte();this.mHeight=LowAPI.Float2Int(Math_Abs(((this.mLife%this.mLifeDim)*d.PARTICLE_CONFETTI_SIZE/this.mLifeDim)-(d.PARTICLE_CONFETTI_SIZE>>1))).castToByte();break}};d.setSpecialSpeedLine=function(f){d.showSpecial=f};d.showSpecialSpeedLine=function(){return d.showSpecial};d.prototype.initParticle=function(m,k,f,o,l,g,j){this.xPos=m;this.yPos=k;this.xPosInit=m;this.yPosInit=k;this.mType=f;this.t=0;this.mKey=o;this.mSegment=j;switch(this.mType){case d.PARTICLE_TYPE_SPEED_LINE:this.mLife=1;if(d.showSpecialSpeedLine()){this.mColor=((3137339392).castToInt()|Math_Rand(225,251)<<16|Math_Rand(93,145)<<8|Math_Rand(0,1)).castToInt()}else{this.mColor=((3137339392).castToInt()|Math_Rand(152,237)<<16|Math_Rand(193,245)<<8|Math_Rand(225,251)).castToInt()}this.mAngle=Math_DegreeToFixedPointAngle(Math_Rand(0,360));this.mLength=Math_Rand(125,160);this.mSpeed=o+Math_Rand(50,80);var i=Math_FixedPoint_Subtract(Math_Angle90,Math_Abs(this.mAngle));this.xPos+=LowAPI.Float2Int(3*this.SGN(this.mAngle)*Math_FixedPointToInt((Math_Cos(i)*this.mSpeed/2)));this.yPos+=LowAPI.Float2Int(Math_FixedPointToInt(Math_Sin(i)*this.mSpeed/2)*3/2);break;case d.PARTICLE_TYPE_ENGINE_SMOKE:this.mAngle=Math_DegreeToFixedPointAngle(Math_Rand(-d.PARTICLE_ENGINE_SMOKE_MAX_ANGLE,d.PARTICLE_ENGINE_SMOKE_MAX_ANGLE));if(o<d.k_horizontal_smoke_start_speed){this.mSpeed=LowAPI.Float2Int((o-d.k_horizontal_smoke_start_speed)/15);this.mLife=Math_Rand(500,4500);this.mAngle=Math_DegreeToFixedPointAngle(Math_Rand(-d.PARTICLE_ENGINE_SMOKE_MAX_ANGLE>>1,d.PARTICLE_ENGINE_SMOKE_MAX_ANGLE>>1))}else{this.mSpeed=2+LowAPI.Float2Int((o-d.k_horizontal_smoke_start_speed)/30);this.mLife=Math_Rand(1500,2200)}if(this.mSpeed>-2&&this.mSpeed<2){this.mLife=Math_Rand(1700,2200)}if(this.mSpeed>5){this.mSpeed=5}this.mHeight=0;this.mLifeDim=0;this.mImageArray=g;break;case d.PARTICLE_TYPE_COLLISION:this.mColor=((3137339392).castToInt()|16711680|Math_Rand(180,232)<<8|Math_Rand(0,177)).castToInt();this.mLife=Math_Rand(1500,1800);var i=Math_DegreeToFixedPointAngle(Math_Rand(0,d.PARTICLE_COLLISION_MAX_ANGLE));this.mAngle=0;this.mLength=Math_DegreeToFixedPointAngle(Math_Rand(5,20));this.mHeight=Math_Rand(1,3).castToByte();if(o==d.PARTICLE_SIDE_RIGHT){this.mAngle=d.PARTICLE_COLLISION_ANGLE+i;this.mNrStep=0}if(o==d.PARTICLE_SIDE_LEFT){this.mAngle=-d.PARTICLE_COLLISION_ANGLE-i;this.mNrStep=1}this.mSpeed=Math_Rand(4,9);break;case d.PARTICLE_TYPE_SPARKS:this.mLife=d.PARTICLE_SPARKS_LIFE;this.mSpeed=Math_Rand(d.PARTICLE_SPARKS_SPEED_MIN,d.PARTICLE_SPARKS_SPEED_MAX);if(l==d.PARTICLE_TYPE_LANDING_SPARKS){this.mSpeed=Math_Rand(d.PARTICLE_LANDING_SPARKS_SPEED_MIN,d.PARTICLE_LANDING_SPARKS_SPEED_MAX)}var i=0;if(l==d.PARTICLE_TYPE_LANDING_SPARKS){i=Math_DegreeToFixedPointAngle(Math_Rand(0,d.PARTICLE_LANDING_SPARCLES_MAX_ANGLE))}else{i=Math_DegreeToFixedPointAngle(Math_Rand(0,d.PARTICLE_SPARKS_MAX_ANGLE))}this.mAngle=0;if(l==d.PARTICLE_TYPE_LANDING_SPARKS){this.mAngle=d.PARTICLE_LANDING_SPARKS_ANGLE+i}else{this.mAngle=d.PARTICLE_SPARKS_ANGLE+i}if(o==d.PARTICLE_SIDE_LEFT){this.mAngle=-this.mAngle}this.mLength=Math_Rand(d.PARTICLE_SPARKS_LENGHT>>1,d.PARTICLE_SPARKS_LENGHT);this.mColor=((3137339392).castToInt()|16711680|Math_Rand(180,232)<<8|Math_Rand(0,177)).castToInt();this.mHeight=Math_Rand(0,d.PARTICLE_MAX_HEIGHT).castToByte();this.mNrStep=Math_Rand(2,5).castToByte();this.mStep=0;break;case d.PARTICLE_TYPE_LINE_SPARKS:this.mLife=d.PARTICLE_LINE_SPARKS_LIFE;this.mSpeed=Math_Rand(d.PARTICLE_LINE_SPARKS_SPEED_MIN,d.PARTICLE_LINE_SPARKS_SPEED_MAX);var i=Math_DegreeToFixedPointAngle(Math_Rand(0,d.PARTICLE_LINE_SPARKS_MAX_ANGLE));this.mAngle=d.PARTICLE_LINE_SPARKS_ANGLE+i;if(o==d.PARTICLE_SIDE_LEFT){this.mAngle=-this.mAngle}this.mLength=Math_Rand(d.PARTICLE_LINE_SPARKS_LENGHT>>1,d.PARTICLE_LINE_SPARKS_LENGHT);this.mColor=((3137339392).castToInt()|16711680|Math_Rand(180,232)<<8|Math_Rand(0,177)).castToInt();this.mNrStep=Math_Rand(2,5).castToByte();this.mStep=0;break;case d.PARTICLE_TYPE_BONUS:this.mColor=GetRandomBrightnessColorRGB(l,80,100);this.mLife=Math_Rand(1500,2500);var i=Math_DegreeToFixedPointAngle(Math_Rand(0,d.PARTICLE_BONUS_MAX_ANGLE));this.mAngle=0;this.mLength=Math_DegreeToFixedPointAngle(Math_Rand(3,8));this.mHeight=Math_Rand(2,4).castToByte();if(o==d.PARTICLE_SIDE_RIGHT){this.mAngle=d.PARTICLE_BONUS_ANGLE+i;this.mNrStep=0}if(o==d.PARTICLE_SIDE_LEFT){this.mAngle=-d.PARTICLE_BONUS_ANGLE-i;this.mNrStep=1}this.mSpeed=Math_Rand(7,14);break;case d.PARTICLE_TYPE_LANDING_SPARKS:this.mColor=((3137339392).castToInt()|16711680|Math_Rand(180,232)<<8|Math_Rand(0,177)).castToInt();this.mLife=Math_Rand(2500,4300);this.mAngle=Math_DegreeToFixedPointAngle(Math_Rand(-d.PARTICLE_LANDING_SPARCLES_MAX_ANGLE,d.PARTICLE_LANDING_SPARCLES_MAX_ANGLE));this.mSpeed=Math_Rand(4,9);this.mHeight=Math_Rand(1,2).castToByte();break;case d.PARTICLE_TYPE_TEXTURE_DESTROY:this.mColor=GetRandomBrightnessColorRGB(l,80,120);this.mLife=Math_Rand(1500,2500);var i=Math_DegreeToFixedPointAngle(Math_Rand(0,d.PARTICLE_BONUS_MAX_ANGLE));this.mAngle=0;this.mLength=Math_DegreeToFixedPointAngle(Math_Rand(1,3));this.mHeight=Math_Rand(3,6).castToByte();if(o==d.PARTICLE_SIDE_RIGHT){this.mAngle=d.PARTICLE_BONUS_ANGLE+i;this.mNrStep=0}if(o==d.PARTICLE_SIDE_LEFT){this.mAngle=-d.PARTICLE_BONUS_ANGLE-i;this.mNrStep=1}this.mSpeed=Math_Rand(14,20);break;case d.PARTICLE_TYPE_WATERFALL_LEFT:case d.PARTICLE_TYPE_WATERFALL_RIGHT:if(this.mType==d.PARTICLE_TYPE_WATERFALL_RIGHT){this.mAngle=1}else{if(this.mType==d.PARTICLE_TYPE_WATERFALL_LEFT){this.mAngle=-1}}this.mSpeed=Math_Rand(3,6);this.mCoefficient=Math_Rand(8,30);this.mLife=Math_Rand(5000,8000);this.mHeight=s_waterfallSize.castToByte();this.mImageArray=g;if(!BuildConf.k_use_sprite_waterfall){this.mColor=GetRandomBrightnessColorRGB(48895,100,130)}updateParticle(s_dt);break;case d.PARTICLE_TYPE_FIREWORKS:var h=Math_Rand(-17,17);this.mAngle=Math_DegreeToFixedPointAngle(h);this.xPos=this.yPos=0;this.mKey=o;this.mZoom=100;this.mSpeed=Math_Rand(10,25);this.mLifeDim=this.mLife=Math_Rand(3000,4000);this.mHeight=1;this.mColor=GetRandomBrightnessColorRGB(l,80,120);updateParticle(LowAPI.Float2Int(s_dt/2));break;case d.PARTICLE_TYPE_IMAGE_DESTROY:this.mColor=l;this.mLifeDim=0;this.mLength=Math_DegreeToFixedPointAngle(Math_Rand(9,20));if(o==d.PARTICLE_IMAGE_DESTROY_TYPE1){this.mAngle=Math_DegreeToFixedPointAngle(Math_Rand(-120,120));this.mLife=Math_Rand(3500,4500);this.mNrStep=(this.mAngle>0?1:-1).castToByte()}else{if(o==d.PARTICLE_IMAGE_DESTROY_TYPE2){this.mAngle=Math_DegreeToFixedPointAngle(90);this.mLife=Math_Rand(1500,5500);this.mNrStep=0}}this.mHeight=8;this.mSpeed=Math_Rand(7,12);break;case d.PARTICLE_TYPE_SPLASH_DESTROY:this.mColor=0;this.mLife=Math_Rand(1500,2500);var i=Math_DegreeToFixedPointAngle(Math_Rand(-120,120));this.mLength=Math_DegreeToFixedPointAngle(Math_Rand(7,15));this.mHeight=Math_Rand(7,11).castToByte();this.mAngle=i;this.mNrStep=(this.mAngle>0?1:-1).castToByte();this.mSpeed=Math_Rand(8,15);break;case d.PARTICLE_TYPE_CURSOR_LEFT:case d.PARTICLE_TYPE_CURSOR_RIGHT:this.mAngle=Math_DegreeToFixedPointAngle(0);this.mZoom=100;if(this.mType==d.PARTICLE_TYPE_CURSOR_RIGHT){this.mSpeed=-1}else{this.mSpeed=1}this.mLifeDim=this.mLife=l;this.mHeight=1;this.mColor=GetRandomBrightnessColorRGB((3707078).castToInt(),80,120);break;case d.PARTICLE_TYPE_SNOW:this.mLife=Math_Rand(15000,26000);this.mColor=GetRandomBrightnessColorRGB((16777215).castToInt(),90,100);this.mAngle=Math_DegreeToFixedPointAngle(Math_Rand(-25,25));var n=MPS_2_KMH(s_player._speed);this.mLength=Math_Rand(5,40);if(n>150){this.mLength=40}this.mHeight=LowAPI.Float2Int((4-this.mLength/10)).castToByte();this.mSpeed=Math_Rand(1,3);break;case d.PARTICLE_TYPE_CONFETTI:this.mLife=Math_fixedPointTime(Math_Rand(10000,12000));this.mLifeDim=Math_Rand(d.PARTICLE_CONFETTI_ROTATE_PERIOD-(d.PARTICLE_CONFETTI_ROTATE_PERIOD>>1),d.PARTICLE_CONFETTI_ROTATE_PERIOD+(d.PARTICLE_CONFETTI_ROTATE_PERIOD>>1));this.mColor=RGB2Int(Math_Rand(0,255),Math_Rand(0,255),Math_Rand(0,255));this.mAngle=Math_Rand(5,35);this.mAngle=(o==d.PARTICLE_SIDE_LEFT)?this.mAngle:-this.mAngle;this.mAngle=Math_DegreeToFixedPointAngle(this.mAngle);this.mNrStep=Math_Rand(0,2).castToByte();this.mLength=Math_Rand(d.PARTICLE_CONFETTI_DIRECTION_CHANGE_TIME-(d.PARTICLE_CONFETTI_DIRECTION_CHANGE_TIME>>1),d.PARTICLE_CONFETTI_DIRECTION_CHANGE_TIME+(d.PARTICLE_CONFETTI_DIRECTION_CHANGE_TIME>>1));this.mCoefficient=0;this.mSpeed=this.mSpeedInit=Math_Rand(30,70);this.mWeight=Math_Rand(2,4);break}};d.prototype.renderParticle=function(m){switch(this.mType){case d.PARTICLE_TYPE_SPEED_LINE:if(this.isAlive()){var j=Math_Angle90-Math_Abs(this.mAngle);var i=this.xPos+(this.SGN(this.mAngle)*Math_FixedPointToInt(Math_Cos(j)*this.mLength)).castToInt();var q=LowAPI.Float2Int(this.yPos+(Math_FixedPointToInt(Math_Sin(j)*this.mLength)*3)/4);SetColor(this.mColor);if(d.showSpecialSpeedLine()){FillTriangle(this.xPos,this.yPos,i+2,q,i-2,q-4)}else{FillTriangle(this.xPos,this.yPos,i+1,q,i-1,q-2)}}break;case d.PARTICLE_TYPE_COLLISION:case d.PARTICLE_TYPE_BONUS:case d.PARTICLE_TYPE_TEXTURE_DESTROY:case d.PARTICLE_TYPE_LANDING_SPARKS:SetColor(this.mColor);FillRect(this.xPos,this.yPos,this.mHeight,this.mHeight);break;case d.PARTICLE_TYPE_IMAGE_DESTROY:SetColor(GetRandomBrightnessColorRGB(this.mColor,120,120));FillRect(this.xPos,this.yPos,this.mHeight,this.mHeight);SetColor(this.mColor);FillRect(this.xPos+1,this.yPos+1,this.mHeight-2,this.mHeight-2);break;case d.PARTICLE_TYPE_ENGINE_SMOKE:var l=HCENTER|VCENTER;DrawImage(this.mImageArray[this.mHeight],this.xPos,this.yPos,l);break;case d.PARTICLE_TYPE_SPARKS:var j=Math_FixedPoint_Subtract(Math_Angle90,Math_Abs(this.mAngle));var i=this.xPos+(this.SGN(this.mAngle)*Math_FixedPointToInt(Math_Cos(j)*this.mLength)).castToInt();var q=this.yPos+Math_FixedPointToInt(Math_Sin(j)*this.mLength);SetColor(this.mColor);DrawLine(this.xPos,this.yPos,i,q);break;case d.PARTICLE_TYPE_LINE_SPARKS:var j=Math_FixedPoint_Subtract(Math_Angle90,Math_Abs(this.mAngle));var i=this.xPos+(this.SGN(this.mAngle)*Math_FixedPointToInt(Math_Cos(j)*this.mLength)).castToInt();var q=this.yPos+Math_FixedPointToInt(Math_Sin(j)*this.mLength);SetColor(this.mColor);DrawLine(this.xPos,this.yPos,i,q);break;case d.PARTICLE_TYPE_WATERFALL_LEFT:case d.PARTICLE_TYPE_WATERFALL_RIGHT:var l=HCENTER|VCENTER;var r=LowAPI.Float2Int((this.mZoom*this.xPos)/100);var p=LowAPI.Float2Int((this.mZoom*this.yPos)/100);r+=this.xOffset;p+=this.yOffset;if(BuildConf.k_use_sprite_waterfall){DrawImage(this.mImageArray[this.mHeight],r,p,l)}else{SetColor(this.mColor);FillRect(r,p,this.mHeight+1,this.mHeight+1)}break;case d.PARTICLE_TYPE_FIREWORKS:if(this.mHeight>=0){var j=Math_FixedPoint_Subtract(Math_Angle90,Math_Abs(this.mAngle));var i=LowAPI.Float2Int(this.xPos/2-this.mHeight);var q=this.yPos;var h=LowAPI.Float2Int(this.xPos/2+this.mHeight);var o=this.yPos;var f=LowAPI.Float2Int(this.xPos/2-(this.SGN(this.mAngle)*Math_FixedPointToInt(Math_Cos(j)*this.mSpeed*2))/2).castToInt();var n=this.yPos+Math_FixedPointToInt(Math_Sin(j)*this.mSpeed*2);i=LowAPI.Float2Int(i*this.mZoom/100+this.xOffset);h=LowAPI.Float2Int(h*this.mZoom/100+this.xOffset);f=LowAPI.Float2Int(f*this.mZoom/100+this.xOffset);q=LowAPI.Float2Int(q*this.mZoom/100+this.yOffset);o=LowAPI.Float2Int(o*this.mZoom/100+this.yOffset);n=LowAPI.Float2Int(n*this.mZoom/100+this.yOffset);SetColor(this.mColor);FillTriangle(i,q,h,o,f,n)}break;case d.PARTICLE_TYPE_CURSOR_LEFT:case d.PARTICLE_TYPE_CURSOR_RIGHT:if(this.mHeight>=0){SetColorWithAlpha(this.mColor);FillRect(this.xPos-this.mHeight+this.xOffset,this.yPos-this.mHeight+this.yOffset+Math_Rand(-1,1),this.mHeight,this.mHeight)}break;case d.PARTICLE_TYPE_SPLASH_DESTROY:SetColor(this.mColor);FillArc(this.xPos,this.yPos,this.mHeight,this.mHeight,0,360);break;case d.PARTICLE_TYPE_SNOW:SetColor(this.mColor);FillRect(this.xPos,this.yPos,this.mHeight,this.mHeight);break;case d.PARTICLE_TYPE_CONFETTI:var k=GetRandomBrightnessColorRGB(this.mColor,80+this.mHeight*12,80+this.mHeight*12);SetColor(this.mColor);if(this.mNrStep==0){FillArc(this.xPos-(d.PARTICLE_CONFETTI_SIZE>>2),this.yPos-(this.mHeight>>1),d.PARTICLE_CONFETTI_SIZE>>1,this.mHeight,0,360)}else{FillArc(this.xPos-(this.mHeight>>1),this.yPos-(d.PARTICLE_CONFETTI_SIZE>>2),this.mHeight,d.PARTICLE_CONFETTI_SIZE>>1,0,360)}break}};d.prototype.SGN=function(f){return f<0?-1:1};d.prototype.contructor=function(){this.xPos=-1;this.yPos=-1;this.mType=d.PARTICLE_TYPE_NONE;this.mLife=-1;this.mSpeed=0;this.mAngle=0;this.mLength=0;this.mColor=0;this.mHeight=0;this.mStep=0;this.mNrStep=0};LowAPI.extendObject(a,{cParticle:d,},true)})(window);