(function(t,g){var l={TEXT_ONLY:1,SWIPE_UP:2,SWIPE_DOWN:3,SWIPE_LEFT:4,SWIPE_RIGHT:5,SWIPE_LEFTRIGHT:6,FEVER_MODE:7,SPEED_BOOST:8};function n(){if(s_game_isTutorialAvailable){s_game_iTutorialStep=0;s_game_iTutorialStepActionsCurrent=0;s_game_iTutorialPreStepTimeLeft=TUTORIAL_PRE_FIRST_STEP_DELAY;s_game_iTutorialPostStepTimeLeft=0;s_game_iTutorialEncourageMsgID=0;s_game_distance_tutorialStep=0}else{o(GAME_INTROSTATE_INTRO_OVER)}}function a(){s_game_isTutorialAvailable=true;s_game_isFeverModeTutorialAvailable=true;s_game_isSpeedBoostTutorialAvailable=true;GameVars_SaveAll()}function i(){var v=0;if(s_game_isTutorialAvailable){v=s_game_distance_tutorialStep;s_game_distance_tutorialStep=0}return v}function k(v){if(s_game_isTutorialAvailable){s_game_distance_tutorialStep+=v;return true}else{return false}}function e(){if(!s_game_isTutorialAvailable){return}if(s_game_iTutorialPreStepTimeLeft>0){s_game_iTutorialPreStepTimeLeft-=s_game_frameDT;if(s_game_iTutorialPreStepTimeLeft<=0){s_game_iTutorialPreStepTimeLeft=0;s_game_iTutorialPostStepTimeLeft=0;guiMgr_ActivateGUILayer(GUI_LAYER.TUTORIAL_PROGRESSINFO,true);playSound(SOUND_TYPE.MESSAGE_SFX,false);s_game_distance_tutorialStep=0}}else{if(s_game_iTutorialPostStepTimeLeft>0){s_game_iTutorialPostStepTimeLeft-=s_game_frameDT;if(s_game_iTutorialPostStepTimeLeft<=0){s_game_iTutorialPostStepTimeLeft=0;s_game_iTutorialStep++;s_game_iTutorialStepActionsCurrent=0;guiMgr_ActivateGUILayer(GUI_LAYER.TUTORIAL_PROGRESSINFO,false);if(s_game_iTutorialStep>=TUTORIAL_ACTIONS_PER_STEP.length){floatingText_AddFloatingText(getString(TEXT.MAIN_TUTORIAL_ENCOURAGE_ENDTUTO),2000,0,240,400,0,-30,s_sprFontBig,0);f(true);o(GAME_INTROSTATE_INTRO_OVER)}else{s_game_iTutorialPreStepTimeLeft=TUTORIAL_PRE_STEP_DELAY}}}}}function f(v){s_game_isTutorialAvailable=!v;GameVars_SetRecordValue(RMS_RECORD_TUTORIAL_AVAILABLE,s_game_isTutorialAvailable?1:0,true);CurrentExploits_AddExploitValue(IExploit.EX_T_FINISH_TUTORIAL)}function q(v){s_game_isFeverModeTutorialAvailable=!v;GameVars_SetRecordValue(RMS_RECORD_TUTORIAL_FEVERMODE_AVAILABLE,s_game_isFeverModeTutorialAvailable?1:0,true)}function s(v){s_game_isSpeedBoostTutorialAvailable=!v;GameVars_SetRecordValue(RMS_RECORD_TUTORIAL_SPEEDBOOST_AVAILABLE,s_game_isSpeedBoostTutorialAvailable?1:0,true)}function r(){if(s_game_isFeverModeTutorialAvailable){msgBox_AddMsgBox(MSGBOX_TYPE.TUTORIAL_INFO,getString(TEXT.MAIN_TUTORIAL_FEVER,IDefine.INDEX_MAIN),MSGBOX_CALLBACK.TUTORIAL_FEVER,getString(TEXT.MAIN_UPGRADE_NAME_FEVER,IDefine.INDEX_MAIN));StopSoundChannel(0);StopSoundChannel(s_ambientChannel);playSound(SOUND_TYPE.MESSAGE_SFX,false);q(true);return true}else{return false}}function d(){if(s_game_isSpeedBoostTutorialAvailable){msgBox_AddMsgBox(MSGBOX_TYPE.TUTORIAL_INFO_ICON,getString(TEXT.MAIN_TUTORIAL_SPEEDBOOSTER_SHORT,IDefine.INDEX_MAIN),MSGBOX_CALLBACK.TUTORIAL_FEVER,getString(TEXT.MAIN_TUTORIAL_SPEED_TITLE,IDefine.INDEX_MAIN));StopSoundChannel(0);StopSoundChannel(s_ambientChannel);playSound(SOUND_TYPE.MESSAGE_SFX,false);s(true);return true}else{return false}}function u(v){if(v!=TUTORIAL_ACTION.HIT_GOAL){return}if((s_game_iTutorialStep==0)||(s_game_iTutorialStep==1)){floatingText_AddFloatingText(getString(TEXT.MAIN_TUTORIAL_ENCOURAGE_1+s_game_iTutorialEncourageMsgID),2000,0,240,400,0,-30,s_sprFontBig,0);playSound(SOUND_TYPE.NOTIFY_EXPLOIT_SFX,false);s_game_iTutorialEncourageMsgID=(s_game_iTutorialEncourageMsgID+1)%(TEXT.MAIN_TUTORIAL_ENCOURAGE_LAST-TEXT.MAIN_TUTORIAL_ENCOURAGE_1+1);guiMgr_ActivateGUILayer(GUI_LAYER.TUTORIAL_PROGRESSINFO,false)}s_game_iTutorialStepActionsCurrent++;if(s_game_iTutorialStepActionsCurrent>=TUTORIAL_ACTIONS_PER_STEP[s_game_iTutorialStep]){}j();if(s_game_iTutorialStepActionsCurrent>=TUTORIAL_ACTIONS_PER_STEP[s_game_iTutorialStep]){s_game_iTutorialPostStepTimeLeft=((s_game_iTutorialStep+1)>=TUTORIAL_ACTIONS_PER_STEP.length)?TUTORIAL_POST_ALL_STEPS_DELAY:TUTORIAL_POST_STEP_DELAY}}_register_gui_message(GameData.k_gameTutorial_ProgressInfo,m);function m(w,v){if(w==GUI_MESSAGE_INITIALIZE){gui_ResetAllLayerButtonsPressedState();j();p();switch(s_game_iTutorialStep){case 0:SetGraphItemVisibility(GameData.k_gameTutorial_ProgressInfo,GameData.k_Tutorial_ProgressInfo_Gfx_InfoAnim_SwipeUp,true);break;case 1:SetGraphItemVisibility(GameData.k_gameTutorial_ProgressInfo,GameData.k_Tutorial_ProgressInfo_Gfx_InfoAnim_SwipeDown,true);break;case 2:SetGraphItemVisibility(GameData.k_gameTutorial_ProgressInfo,GameData.k_Tutorial_ProgressInfo_Gfx_InfoAnim_SwipeSideways,true);break}}if(w==GUI_MESSAGE_UPDATE){gui_UpdateGameLayerAnims(GameData.k_gameTutorial_ProgressInfo)}if(w==GUI_MESSAGE_AFTER_PAINT){}if(w==GUI_MESSAGE_INPUT_EVENT){}}function j(){SetTextAreaVisibility(GameData.k_gameTutorial_ProgressInfo,GameData.k_Tutorial_ProgressInfo_Txt_Count,false)}function p(){switch(s_game_iTutorialStep){case 0:SetTextAreaString(GameData.k_gameTutorial_ProgressInfo,GameData.k_Tutorial_ProgressInfo_Txt_Instruction,getString(TEXT.MAIN_TUTORIAL_SHORT_1,IDefine.INDEX_MAIN));break;case 1:SetTextAreaString(GameData.k_gameTutorial_ProgressInfo,GameData.k_Tutorial_ProgressInfo_Txt_Instruction,getString(TEXT.MAIN_TUTORIAL_SHORT_2,IDefine.INDEX_MAIN));break;case 2:SetTextAreaString(GameData.k_gameTutorial_ProgressInfo,GameData.k_Tutorial_ProgressInfo_Txt_Instruction,getString(TEXT.MAIN_TUTORIAL_SHORT_3,IDefine.INDEX_MAIN));break}}function h(v){return((v==l.SWIPE_UP)||(v==l.SWIPE_DOWN)||(v==l.SWIPE_LEFT)||(v==l.SWIPE_RIGHT)||(v==l.SWIPE_LEFTRIGHT))}_register_gui_message(GameData.k_gameTutorial_Info,b);function b(x,w){if(x==GUI_MESSAGE_INITIALIZE){s_showCantGoBack=false;s_showCantGoBack_Time=0;guiMgr_SetLayerInputBlockState(guiMgr_GetGUILayerIndex(guiMgr_iCurrentLayerType),true);gui_ResetAllLayerButtonsPressedState();SetTextAreaString(GameData.k_gameTutorial_Info,GameData.k_Tutorial_Info_Txt_Info,s_msgBoxText);if((s_msgboxText2!=null)&&(s_msgboxText2.length>0)){SetTextAreaString(GameData.k_gameTutorial_Info,GameData.k_Tutorial_Info_Txt_Title,s_msgBoxText2)}switch(s_msgboxData[0][MSGBOX_DATA.EXTRA_PARAM]){case l.SWIPE_UP:SetTextAreaString(GameData.k_gameTutorial_Info,GameData.k_Tutorial_Info_Txt_Info,getString(TEXT.MAIN_TUTORIAL_SWIPE_UP));SetGraphItemVisibility(GameData.k_gameTutorial_Info,GameData.k_Tutorial_Info_Gfx_InfoAnim_Step1,true);break;case l.SWIPE_DOWN:SetTextAreaString(GameData.k_gameTutorial_Info,GameData.k_Tutorial_Info_Txt_Info,getString(TEXT.MAIN_TUTORIAL_SWIPE_DOWN));SetGraphItemVisibility(GameData.k_gameTutorial_Info,GameData.k_Tutorial_Info_Gfx_InfoAnim_Step2,true);break;case l.SWIPE_LEFT:SetTextAreaString(GameData.k_gameTutorial_Info,GameData.k_Tutorial_Info_Txt_Info,getString(TEXT.MAIN_TUTORIAL_SWIPE_LEFT));SetGraphItemVisibility(GameData.k_gameTutorial_Info,GameData.k_Tutorial_Info_Gfx_InfoAnim_Step3,true);break;case l.SWIPE_RIGHT:SetTextAreaString(GameData.k_gameTutorial_Info,GameData.k_Tutorial_Info_Txt_Info,getString(TEXT.MAIN_TUTORIAL_SWIPE_RIGHT));SetGraphItemVisibility(GameData.k_gameTutorial_Info,GameData.k_Tutorial_Info_Gfx_InfoAnim_Step4,true);break;case l.SWIPE_LEFTRIGHT:SetTextAreaString(GameData.k_gameTutorial_Info,GameData.k_Tutorial_Info_Txt_Info,getString(TEXT.MAIN_TUTORIAL_SWIPE_LEFTRIGHT));SetGraphItemVisibility(GameData.k_gameTutorial_Info,GameData.k_Tutorial_Info_Gfx_InfoAnim_Step5,true);break;case l.FEVER_MODE:SetGraphItemVisibility(GameData.k_gameTutorial_Info,GameData.k_Tutorial_Info_Gfx_InfoAnim_ScoreMultiplier,true);break;case l.SPEED_BOOST:SetGraphItemVisibility(GameData.k_gameTutorial_Info,GameData.k_Tutorial_Info_Gfx_InfoAnim_ScoreMultiplier,true);break}guiMgr_layerOffsetData[GUI_LAYER.TUTORIAL_INFO][GUILAYER_DATA_TIMER]=TUTORIALINFO_NOTOUCHDELAY}if(x==GUI_MESSAGE_INPUT_EVENT){if((guiMgr_layerOffsetData[GUI_LAYER.TUTORIAL_INFO][GUILAYER_DATA_TIMER]<=0)){var v=false;switch(s_msgboxData[0][MSGBOX_DATA.EXTRA_PARAM]){case l.SWIPE_UP:game_Update_CheckInputHorizontallyAndVertically();v=(s_lastPlayerAction==PLAYER_ACTION.DRAG_UP);break;case l.SWIPE_DOWN:game_Update_CheckInputHorizontallyAndVertically();v=(s_lastPlayerAction==PLAYER_ACTION.DRAG_DOWN);break;case l.SWIPE_RIGHT:game_Update_CheckInputHorizontallyAndVertically();v=(s_lastPlayerAction==PLAYER_ACTION.DRAG_RIGHT);break;case l.SWIPE_LEFT:game_Update_CheckInputHorizontallyAndVertically();v=(s_lastPlayerAction==PLAYER_ACTION.DRAG_LEFT);break;case l.SWIPE_LEFTRIGHT:game_Update_CheckInputHorizontallyAndVertically();v=((s_lastPlayerAction==PLAYER_ACTION.DRAG_LEFT)||(s_lastPlayerAction==PLAYER_ACTION.DRAG_RIGHT));break;default:v=Input_CheckState_SYNC(INPUT_FLAG_RELEASED);break}if(v){s_showCantGoBack=false;s_showCantGoBack_Time=0;guiMgr_ActivateGUILayer(GUI_LAYER.TUTORIAL_INFO,false,false);if(msgBox_GetCurrentMsgboxCallback()>=0){msgBox_ClickCallback(MSGBOX_ACTION.ACCEPT)}if(h(s_msgboxData[0][MSGBOX_DATA.EXTRA_PARAM])){floatingText_AddFloatingText(getString(TEXT.MAIN_TUTORIAL_ENCOURAGE_1+s_game_iTutorialEncourageMsgID),2000,0,240,400,0,-30,s_sprFontBig,0);s_game_iTutorialEncourageMsgID=(s_game_iTutorialEncourageMsgID+1)%(TEXT.MAIN_TUTORIAL_ENCOURAGE_LAST-TEXT.MAIN_TUTORIAL_ENCOURAGE_1+1)}msgBox_GoToNext();Input_Reset()}}}if(x==GUI_MESSAGE_UPDATE){guiMgr_layerOffsetData[GUI_LAYER.TUTORIAL_INFO][GUILAYER_DATA_TIMER]-=s_game_frameDT;if(guiMgr_layerOffsetData[GUI_LAYER.TUTORIAL_INFO][GUILAYER_DATA_TIMER]<0){guiMgr_layerOffsetData[GUI_LAYER.TUTORIAL_INFO][GUILAYER_DATA_TIMER]=0}var y=false;if(!h(s_msgboxData[0][MSGBOX_DATA.EXTRA_PARAM])&&(guiMgr_layerOffsetData[GUI_LAYER.TUTORIAL_INFO][GUILAYER_DATA_TIMER]<=0)){y=((System.currentTimeMillis()&(1<<9))!=0)}SetTextAreaVisibility(GameData.k_gameTutorial_Info,GameData.k_Tutorial_Info_Txt_TouchToContinue,y);if(s_showCantGoBack){SetTextAreaVisibility(k_gameTutorial_Info,k_Tutorial_Info_txt_CantGoBack,y);s_showCantGoBack_Time+=s_game_frameDT;if(s_showCantGoBack_Time>MAX_CANTGOBACK_TIME){s_showCantGoBack=false;s_showCantGoBack_Time=0;SetTextAreaVisibility(GameData.k_gameTutorial_Info,GameData.k_Tutorial_Info_txt_CantGoBack,false)}}gui_UpdateGameLayerAnims(GameData.k_gameTutorial_Info)}if(x==GUI_MESSAGE_BEFORE_PAINT){guiMgr_PaintDarkBackGround()}if(x==GUI_MESSAGE_AFTER_PAINT){}}_register_gui_message(GameData.k_gameTutorial_Info_Icon,c);function c(w,v){if(w==GUI_MESSAGE_INITIALIZE){s_showCantGoBack=false;s_showCantGoBack_Time=0;guiMgr_SetLayerInputBlockState(guiMgr_GetGUILayerIndex(guiMgr_iCurrentLayerType),true);gui_ResetAllLayerButtonsPressedState();SetTextAreaString(GameData.k_gameTutorial_Info_Icon,GameData.k_Tutorial_Info_Icon_TxtMsg,s_msgBoxText);if((s_msgboxText2!=null)&&(s_msgboxText2.length>0)){SetTextAreaString(GameData.k_gameTutorial_Info_Icon,GameData.k_Tutorial_Info_Icon_Txt_Title,s_msgBoxText2)}guiMgr_layerOffsetData[GUI_LAYER.TUTORIAL_INFO_ICON][GUILAYER_DATA_TIMER]=TUTORIALINFO_NOTOUCHDELAY}if(w==GUI_MESSAGE_INPUT_EVENT){if((guiMgr_layerOffsetData[GUI_LAYER.TUTORIAL_INFO_ICON][GUILAYER_DATA_TIMER]<=0)){if(Input_CheckState_SYNC(INPUT_FLAG_RELEASED)){guiMgr_ActivateGUILayer(GUI_LAYER.TUTORIAL_INFO_ICON,false,false);s_showCantGoBack=false;s_showCantGoBack_Time=0;if(msgBox_GetCurrentMsgboxCallback()>=0){msgBox_ClickCallback(MSGBOX_ACTION.ACCEPT)}msgBox_GoToNext();Input_Reset()}}}if(w==GUI_MESSAGE_UPDATE){guiMgr_layerOffsetData[GUI_LAYER.TUTORIAL_INFO_ICON][GUILAYER_DATA_TIMER]-=s_game_frameDT;if(guiMgr_layerOffsetData[GUI_LAYER.TUTORIAL_INFO_ICON][GUILAYER_DATA_TIMER]<0){guiMgr_layerOffsetData[GUI_LAYER.TUTORIAL_INFO_ICON][GUILAYER_DATA_TIMER]=0}var x=false;if(!h(s_msgboxData[0][MSGBOX_DATA.EXTRA_PARAM])&&(guiMgr_layerOffsetData[GUI_LAYER.TUTORIAL_INFO_ICON][GUILAYER_DATA_TIMER]<=0)){x=((System.currentTimeMillis()&(1<<9))!=0)}SetTextAreaVisibility(GameData.k_gameTutorial_Info_Icon,GameData.k_Tutorial_Info_Icon_Txt_TouchToContinue,x);if(s_showCantGoBack){SetTextAreaVisibility(GameData.k_gameTutorial_Info_Icon,GameData.k_Tutorial_Info_Icon_txt_CantGoBack,x);s_showCantGoBack_Time+=s_game_frameDT;if(s_showCantGoBack_Time>MAX_CANTGOBACK_TIME){s_showCantGoBack=false;s_showCantGoBack_Time=0;SetTextAreaVisibility(GameData.k_gameTutorial_Info_Icon,GameData.k_Tutorial_Info_Icon_txt_CantGoBack,false)}}gui_UpdateGameLayerAnims(GameData.k_gameTutorial_Info_Icon)}if(w==GUI_MESSAGE_BEFORE_PAINT){guiMgr_PaintDarkBackGround()}if(w==GUI_MESSAGE_AFTER_PAINT){}}function o(v){if(s_iIntroState==GAME_INTROSTATE_IN_HEADSTART){if(s_FeverModeEffect!=null){s_FeverModeEffect.Remove()}}switch(v){case GAME_INTROSTATE_IN_HEADSTART:playSound(SOUND_TYPE.FEVER_ACTIVATE_SFX,false);s_FeverModeEffect=cActor.VisualActor_CreateAnimFx(0,0,-10,DATA.SPRITE_DATA_GOLD_EFFECT,GOLD_EFFECT.ANIM_GOLD_MERGE,IActorLists.EFFECTS,0,100000,true);cam_SetDepthFollowData(CAM_SPEEDUP_EFFECT_TIME,s_camDistOffsetFP,CAM_SPEEDUP_EFFECT_AMPLITUDE,0);break;case GAME_INTROSTATE_INTRO_OVER:if(s_iIntroState==GAME_INTROSTATE_IN_HEADSTART){if(s_bCurrentHeadstartBig){s_iDistInLevel=s_arrayTweaks[ITweaks.DISTANCE_PER_ENVIRONMENT][0];s_iDistInEnvironment=s_arrayTweaks[ITweaks.DISTANCE_PER_ENVIRONMENT][0]}else{s_iDistInLevel=s_arrayTweaks[ITweaks.DISTANCE_PER_ENVIRONMENT][0]/3;s_iDistInEnvironment=s_arrayTweaks[ITweaks.DISTANCE_PER_ENVIRONMENT][0]/3}}break}s_iIntroState=v}LowAPI.extendObject(t,{tutorial_Init:n,tutorial_Reset:a,tutorial_Update:e,tutorial_notifyAction:u,tutorial_ShowSpeedBoostModeTutorial:d,tutorial_ShowFeverModeTutorial:r,tutorial_GetAndReset_TutorialStepDistance:i,tutorial_Update_TutorialStepDistance:k,},true)})(window);