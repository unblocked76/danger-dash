(function(D,b){function e(){e.__superclass__.call(this,e.ID,arguments);this.setListenerStateMessage(GameState.MESSAGE_INIT,this.INIT);this.setListenerStateMessage(GameState.MESSAGE_UPDATE,this.UPDATE);this.setListenerStateMessage(GameState.MESSAGE_PAINT,this.PAINT);this.setListenerStateMessage(GameState.MESSAGE_EXIT,this.EXIT)}LowAPI.extendClass(e,GameState);e.ID=GameState.genID();e.prototype.INIT=function(){guiMgr_SetLayerActiveStateAll(false);guiMgr_ResetAllGUILayers();Input_Init();guiMgr_ActivateGUILayer(GUI_LAYER.STATS,true);StopSound(SOUND_MODE.MUSIC)};e.prototype.UPDATE=function(){guiMgr_processInputAllGuiLayers();guiMgr_updateLayers()};e.prototype.PAINT=function(){guiMgr_PaintGUILayers()};e.prototype.EXIT=function(){guiMgr_ActivateGUILayer(GUI_LAYER.STATS,false)};function x(){GameState.scheduleSwitchState(GameState_MENUMAIN.ID,true,true);guiMgr_ActivateGUILayer(GUI_LAYER.STATS,false);playSound(SOUND_TYPE.BACK_SFX,false)}_register_gui_message(GameData.k_gameStats,k);function k(G,F){if(G==GUI_MESSAGE_INITIALIZE){s_playerLastPointerMode=INPUT_FLAG_PRESSED;gui_ResetAllLayerButtonsPressedState();guiMgr_SetLayerInputBlockState(guiMgr_GetGUILayerIndex(guiMgr_iCurrentLayerType),true);guiMgr_SetLayerPaintBlockState(guiMgr_GetGUILayerIndex(guiMgr_iCurrentLayerType),true);updateCurrencyHUD();SetButtonEnabled(GameData.k_gameStats,GameData.k_Stats_btnStats,false);c();h();p();a(B.STATE_START);SetButtonVisibility(GameData.k_gameStats,GameData.k_Stats_btnAddCoins,false)}if(G==GUI_MESSAGE_UPDATE){C();j()}if(G==GUI_MESSAGE_AFTER_PAINT){r(true)}if(G==GUI_MESSAGE_INPUT_EVENT){switch(F){case GameData.k_Stats_btnExit:x();break;case GameData.k_Stats_btnExploits:GameState.scheduleSwitchState(GameState_EXPLOITS.ID,true,true);guiMgr_ActivateGUILayer(GUI_LAYER.STATS,false);playSound(SOUND_TYPE.SELECT_SFX,false);break;case GameData.k_Stats_btnAchievements:GameState.scheduleSwitchState(GameState_ACHIEVEMENTS.ID);guiMgr_ActivateGUILayer(GUI_LAYER.STATS,false);playSound(SOUND_TYPE.SELECT_SFX,false);break;case GameData.k_Stats_btnAddCoins:guiMgr_ActivateGUILayer(GUI_LAYER.STATS,false);s_IAP_bChosen=true;IapMgr_Start(s_iCurrentState,false,false);playSound(SOUND_TYPE.SELECT_SFX,false);break}}}function C(){switch(f){case B.STATE_START:A();break;case B.STATE_MIDDLE:u();break;case B.STATE_END:break}}function A(){s_frameCounter++;if(s_frameCounter>=B.TIME_START){a(B.STATE_MIDDLE)}else{}}function u(){s_frameCounter++;if(s_frameCounter>=B.TIME_MIDDLE){a(B.STATE_END)}}function E(){}function l(){s_frameCounter=0}function w(){SetButtonVisibility(GameData.k_gameStats,GameData.k_Stats_btnExit,true)}function a(F){switch(F){case B.STATE_START:E();break;case B.STATE_MIDDLE:l();break;case B.STATE_END:w();break}f=F}var B={};B.STATE_START=0;B.STATE_MIDDLE=1;B.STATE_END=2;B.TIME_START=30;B.TIME_MIDDLE=30;var f=-1;var d={};d.GFX_BG=0;d.TXT_NAME=d.GFX_BG+1;d.GFX_PROGRESS_BG=d.TXT_NAME+1;d.GUI_PROGRESS=d.GFX_PROGRESS_BG+1;d.TXT_PROGRESS=d.GUI_PROGRESS+1;d.GFX_ICON=d.TXT_PROGRESS+1;d.TXT_DESC=d.GFX_ICON+1;d.SIZE=d.TXT_DESC+1;var o=new cScrollMenu(0,0,0,0,0,0,0);var v=[0,0,0,0];var n;var m;var s=-1;var i=0;function y(){var F=-1;F=1;o.SetElementCounter(F);return F}function c(){GetRectAreaRect(s_gui_outRect,GameData.k_gameStats,GameData.k_Stats_rectScroll);var I=s_gui_outRect[2]-s_gui_outRect[0];var G=s_gui_outRect[3]-s_gui_outRect[1];o.Reset();o.SetRowLength(1);o.SetDirection(cScrollMenu.SCROLL_DIRECTION_VERTICAL);o.SetWindowWidth(GetParamValue(GameData.k_gameStats,GameData.k_Stats_ScrollData,GtsData.GUI_SCROLLDATA_WIDTH));o.SetWindowHeight(GetParamValue(GameData.k_gameStats,GameData.k_Stats_ScrollData,GtsData.GUI_SCROLLDATA_HEIGHT));var F=y();var H=GetParamValue(GameData.k_gameStatsScrollContent,GameData.k_StatsScrollContent_Txt_Deaths,GtsData.GUI_POSY)-GetParamValue(GameData.k_gameStatsScrollContent,GameData.k_StatsScrollContent_Txt_title,GtsData.GUI_POSY)+45;o.SetElemWidth(I+1);o.SetElemHeight(G+1);o.SetElemSpacingX(I);o.SetElemSpacingY((H/F)|0);o.SetLockStateX(true);o.SetLockStateY(false);n=s_gui_outRect[0];m=s_gui_outRect[1];v[0]=GetParamValue(GameData.k_gameStats,GameData.k_Stats_ScrollData,GtsData.GUI_POSX)+GetParamValue(GameData.k_gameStats,GameData.k_Stats_ScrollData,GtsData.GUI_SCROLLDATA_POSX);v[1]=GetParamValue(GameData.k_gameStats,GameData.k_Stats_ScrollData,GtsData.GUI_POSY)+GetParamValue(GameData.k_gameStats,GameData.k_Stats_ScrollData,GtsData.GUI_SCROLLDATA_POSY);v[2]=GetParamValue(GameData.k_gameStats,GameData.k_Stats_ScrollData,GtsData.GUI_SCROLLDATA_WIDTH);v[3]=GetParamValue(GameData.k_gameStats,GameData.k_Stats_ScrollData,GtsData.GUI_SCROLLDATA_HEIGHT);o.Reset();s=-1;i=0}function h(){s_systemExploits=0;for(var F=0;F<s_arrayExploits.length;F++){if(GameVars_GetRecordValue(RMS_RECORD_EXPLOITS+F,0)==2){s_systemExploits++}}s_systemAchievements=0;for(var F=0;F<s_arrayAchievementsComplete.length;F++){if(s_arrayAchievementsComplete[F]){s_systemAchievements++}}s_systemArtifacts=0;for(var F=0;F<3;F++){s_systemArtifacts+=GameVars_GetRecordValue(RMS_RECORD_ARTIFACTS+F,0)}}function p(){SetTextAreaString(GameData.k_gameStatsScrollContent,GameData.k_StatsScrollContent_Txt_highscoreValue,""+text_GetFormatNumber(DecodeInt(s_systemScore)));SetTextAreaString(GameData.k_gameStatsScrollContent,GameData.k_StatsScrollContent_Txt_longestRunValue,""+text_GetFormatNumber((DecodeInt(s_systemDistance)/1000)|0));SetTextAreaString(GameData.k_gameStatsScrollContent,GameData.k_StatsScrollContent_Txt_mostCoinsValue,""+text_GetFormatNumber(DecodeInt(GameVars_GetRecordValue(RMS_RECORD_BEST_COINS))));SetTextAreaString(GameData.k_gameStatsScrollContent,GameData.k_StatsScrollContent_Txt_totalRunsValue,""+text_GetFormatNumber(s_systemRuns));SetTextAreaString(GameData.k_gameStatsScrollContent,GameData.k_StatsScrollContent_Txt_totalDistanceValue,""+text_GetFormatNumber_Long(DecodeLong(s_systemTotalDistance)/1000));SetTextAreaString(GameData.k_gameStatsScrollContent,GameData.k_StatsScrollContent_Txt_totalCoinsValue,""+text_GetFormatNumber(DecodeInt(s_systemTotalCoins)));SetTextAreaString(GameData.k_gameStatsScrollContent,GameData.k_StatsScrollContent_Txt_exploitsValue,""+s_systemExploits+"/"+s_arrayExploits.length);SetTextAreaString(GameData.k_gameStatsScrollContent,GameData.k_StatsScrollContent_Txt_achievementsValue,""+s_systemAchievements+"/"+s_arrayAchievements.length);SetTextAreaString(GameData.k_gameStatsScrollContent,GameData.k_StatsScrollContent_Txt_artifactsValue,""+text_GetFormatNumber(s_systemArtifacts));SetTextAreaString(GameData.k_gameStatsScrollContent,GameData.k_StatsScrollContent_Txt_ankhValue,""+text_GetFormatNumber(s_systemAnkh));SetTextAreaString(GameData.k_gameStatsScrollContent,GameData.k_StatsScrollContent_Txt_goldrushValue,""+text_GetFormatNumber(s_systemGoldrush));SetTextAreaString(GameData.k_gameStatsScrollContent,GameData.k_StatsScrollContent_Txt_bagofcoinsValue,""+text_GetFormatNumber(s_systemBagofcoins));SetTextAreaString(GameData.k_gameStatsScrollContent,GameData.k_StatsScrollContent_Txt_mountValue,""+text_GetFormatNumber(s_systemMount));SetTextAreaString(GameData.k_gameStatsScrollContent,GameData.k_StatsScrollContent_Txt_speedupValue,""+text_GetFormatNumber(s_systemSpeedUp));SetTextAreaString(GameData.k_gameStatsScrollContent,GameData.k_StatsScrollContent_Txt_speeddownValue,""+text_GetFormatNumber(s_systemSpeedDown));SetTextAreaString(GameData.k_gameStatsScrollContent,GameData.k_StatsScrollContent_Txt_cratesValue,""+text_GetFormatNumber(s_systemCrates));var F=(s_playerCurrentFame*100/s_nextLevelFame)|0;GUI_SetProgressBarProgress(GameData.k_gameStatsScrollContent,GameData.k_StatsScrollContent_GUI_ProgressBar,F);SetTextAreaString(GameData.k_gameStatsScrollContent,GameData.k_StatsScrollContent_Txt_title,getString(TEXT.MAIN_TITLE_00+s_playerTitle));SetTextAreaString(GameData.k_gameStatsScrollContent,GameData.k_StatsScrollContent_Txt_bar_amount,""+s_playerCurrentFame+"/"+s_nextLevelFame);SetTextAreaString(GameData.k_gameStatsScrollContent,GameData.k_StatsScrollContent_Txt_multiplierValue,"x"+DecodeInt(s_system_scoreMultiplier));if(s_playerTitle==(s_arrayTitles.length-1)){SetTextAreaString(GameData.k_gameStatsScrollContent,GameData.k_StatsScrollContent_Txt_multiplierNextValue,"");GUI_SetProgressBarProgress(GameData.k_gameStatsScrollContent,GameData.k_StatsScrollContent_GUI_ProgressBar,100)}else{SetTextAreaString(GameData.k_gameStatsScrollContent,GameData.k_StatsScrollContent_Txt_multiplierNextValue,"x"+(DecodeInt(s_system_scoreMultiplier)+1))}}function j(){o.Update(s_game_frameDT);var H=Input_GetPointerPosX_SYNC();var G=Input_GetPointerPosY_SYNC();if(isPointInRectWH(H,G,v)){if(Input_IsPointerDragged_SYNC()){o.ApplyDisplacement(Input_GetDragOffsetX_SYNC(),Input_GetDragOffsetY_SYNC());if(((Input_GetDraggedPosY_SYNC()-Input_GetPressedPosY_SYNC())<0?-(Input_GetDraggedPosY_SYNC()-Input_GetPressedPosY_SYNC()):(Input_GetDraggedPosY_SYNC()-Input_GetPressedPosY_SYNC()))>SCROLL_ALLOWINPUTDRAG_THRESHOLD){s_bAllowInputInScroll=false}}if(Input_IsPointerPressed_SYNC()){s_bAllowInputInScroll=true}if(!s_bAllowInputInScroll){z(0,10000,10000,INPUT_FLAG_RELEASED)}else{if(Input_CheckState_SYNC(INPUT_FLAG_DRAGGED|INPUT_FLAG_PRESSED)){if(Input_CheckState_SYNC(INPUT_FLAG_DRAGGED)&&s_playerLastPointerMode==INPUT_FLAG_PRESSED&&((Input_GetDragOffsetY_SYNC())<0?-(Input_GetDragOffsetY_SYNC()):(Input_GetDragOffsetY_SYNC()))>2){playSound(SOUND_TYPE.PLAYER_SIDE_MOVE_SFX,false);s_playerLastPointerMode=INPUT_FLAG_DRAGGED}else{if(Input_CheckState_SYNC(INPUT_FLAG_PRESSED)){s_playerLastPointerMode=INPUT_FLAG_PRESSED}}var F=o.GetElementAt(Input_GetPointerPosX_SYNC()-n,Input_GetPointerPosY_SYNC()-m);if((F>=0)){s=F;z(F,0,0,INPUT_FLAG_RELEASED)}}if(Input_CheckState(INPUT_FLAG_RELEASED)){o.SetVelocity(Input_GetDragOffsetX_SYNC(),Input_GetDragOffsetY_SYNC(),4);var F=o.GetElementAt(Input_GetPointerPosX_SYNC()-n,Input_GetPointerPosY_SYNC()-m);if((F>=0)){i=F;z(F,0,0,INPUT_FLAG_RELEASED);o.ResetVelocity();s=-1}}}}}function z(H,F,I,G){scroll_doElementClick(o,GameData.k_gameStatsScrollContent,H,F,I,G)}function q(){var F=o.GetScrollOffsetX();var G=o.GetScrollOffsetY();PaintAllVisibleItems(GameData.k_gameStatsScrollContent,F,G)}function r(G){gui_SetClip(v[0],v[1],v[2],v[3]);var F=0;var H=0;q();gui_RestoreClip();o.Paint(g,n,m);if(G){o.PaintScrollBar(g,SCROLLBAR_BACK,SCROLLBAR_FRONT,(v[0]+v[2]-11),v[1],7,v[3],v[2],v[3])}}function t(G,F){}LowAPI.extendObject(D,{GameState_STATS:e,Stats_Precalculate:h,},true)})(window);