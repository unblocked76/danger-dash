(function(b,c){function a(){this.__GLLibPlayer_ASprite__initialization__();this.__GLLibPlayer_ASprite_FrameMapping__initialization__();if(arguments){switch(arguments.length){case 0:return this.constructor_0.apply(this,arguments);case 3:return this.constructor_3.apply(this,arguments)}}throw new Error("InvalidArguments")}a.k_animBaseFrameTime=LowAPI.Float2Int(1000/GLLibConfig.sprite_animFPS);a.k_AnimNone=-1;a.prototype.constructor_0=function(){this.Reset()};a.prototype.constructor_3=function(e,d,f){if(!((GLLibConfig.sprite_animFPS<=1000))){Assert(false,"GLLibPlayer : Invalid value of GLLibConfig.sprite_animFPS > 1000")}this.Reset();this.posX=d;this.posY=f;this.SetSprite(e)};a.prototype.__GLLibPlayer_ASprite__initialization__=function(){this.posX=0;this.posY=0;this.curFlags=0;this.sprite=null;this.curAnim=0;this.curFrame=0;this.curTime=0;this.curAnimFrameDuration=0;this.nbLoop=0;this.animIsOver=false;this.curBlend=0;this.curScale=0;this.palette=0};a.prototype.Reset=function(){this.posX=0;this.posY=0;this.curAnim=a.k_AnimNone;this.curFrame=0;this.sprite=null;this.curFlags=0;this.curTime=0;this.nbLoop=1;this.palette=-1;this.animIsOver=true};a.prototype.SetPos=function(d,e){this.posX=d;this.posY=e};a.prototype.GetSprite=function(){return this.sprite};a.prototype.SetSprite=function(d){this.sprite=d;if(this.sprite!=null){this.SetAnim(a.k_AnimNone,-1)}else{this.curAnim=a.k_AnimNone}};a.prototype.SetAnim=function(){if(arguments){switch(arguments.length){case 1:return this._SetAnim_I.apply(this,arguments);case 2:return this._SetAnim_II.apply(this,arguments);case 3:var d=typeof arguments[2];if(d=="number"){return this._SetAnim_III.apply(this,arguments)}else{return this._SetAnim_IIZ.apply(this,arguments)}}}throw new Error("InvalidArguments")};a.prototype._SetAnim_I=function(d){Warning("GLLibPlayer.SetAnim(int anim) . this function is deprecated, use GLLibPlayer.SetAnim(int anim, int nbLoop) instead");this.SetAnim(d,-1)};a.prototype._SetAnim_IIZ=function(f,e,d){if(d){this.SetAnim(a.k_AnimNone,1)}this.SetAnim(f,e)};a.prototype._SetAnim_II=function(e,d){this.SetAnim(e,d,-1)};a.prototype._SetAnim_III=function(f,e,d){if(!(this.sprite!=null)){Assert(false,"GLLibPlayer.SetAnim().sprite is not set")}if(!((f<this.GetNbanim()))){Assert(false,"GLLibPlayer.SetAnim().anim out of range")}if(!((e!=0))){Assert(false,"GLLibPlayer.SetAnim().nbLoop is invalid")}if(this.animIsOver||(f!=this.curAnim)){this.curAnim=f;this.curAnimFrameDuration=d==-1?a.k_animBaseFrameTime:LowAPI.Float2Int(d/this.GetNbFrame(false));this.SetFrame(0);this.nbLoop=e-1;this.animIsOver=false}};a.prototype.GetAnim=function(){return this.curAnim};a.prototype.SetFrame=function(e){if(!(this.sprite!=null)){Assert(false,"GLLibPlayer.SetFrame().sprite is not set")}if(!(e>=0)){Assert(false,"GLLibPlayer.SetFrame().frame is negative")}if(this.curAnim<0){return -1}var d=this.GetNbFrame();e%=d;this.curFrame=e;this.curTime=0;return e};a.prototype.RandomizeAnim=function(){this.curFrame=Math_Rand(0,this.GetNbFrame());this.curTime=0};a.prototype.GetFrame=function(){return this.curFrame};a.prototype.GetAnimFrame=function(){if(this.sprite==null||this.curAnim==a.k_AnimNone){return -1}return this.sprite.GetAnimFrame(this.curAnim,this.curFrame)};a.prototype.SetPalette=function(d){this.palette=d};a.prototype.GetNbanim=function(){if(!(this.sprite!=null)){Assert(false,"GLLibPlayer.GetNbanim().sprite is not set")}return this.sprite.GetAnimationCount()};a.prototype.GetNbFrame=function(f){var f=f;if(arguments.length<1){f=true}if(!(this.sprite!=null)){Assert(false,"GLLibPlayer.GetNbFrame().sprite is not set")}if(this.curAnim>=0){if(f){return this.sprite.GetAFrames(this.curAnim)}else{var e=0;for(var d=0;d<this.sprite.GetAFrames(this.curAnim);d++){e+=this.sprite.GetAFrameTime(this.curAnim,d)}return e}}else{return -1}};a.prototype.GetDuration=function(){if(!(this.sprite!=null)){Assert(false,"GLLibPlayer.GetDuration().sprite is not set")}if(this.curAnim>=0){return this.sprite.GetAFrameTime(this.curAnim,this.curFrame)*this.curAnimFrameDuration}else{return 0}};a.prototype.IsAnimOver=function(){if(!(this.sprite!=null)){Assert(false,"GLLibPlayer.isAnimOver().sprite is not set")}if(this.curAnim<0){return true}if(this.nbLoop<0){return false}return this.animIsOver};a.prototype.Render=function(){if(!(this.sprite!=null)){Assert(false,"GLLibPlayer.render().sprite is not set")}if(this.curAnim<0){return}if(!GLLibConfig.sprite_animStillDrawWhenOver){if(this.animIsOver){return}}var e=false;if(GLLibConfig.sprite_useFrameMapping){ApplyFrameMapping()}if(this.palette!=-1){var d=this.sprite.GetCurrentPalette();this.sprite.SetCurrentPalette(this.palette);this.sprite.PaintAFrame(g,this.curAnim,this.curFrame,this.posX,this.posY,this.curFlags);this.sprite.SetCurrentPalette(d)}else{this.sprite.PaintAFrame(g,this.curAnim,this.curFrame,this.posX,this.posY,this.curFlags)}};a.prototype.Update=function(d){var d=d;if(arguments.length<1){if(GLLibConfig.sprite_animFPS==1000){d=1}else{d=s_game_frameDT}}if(!(d>=0)){Assert(false,"GLLibPlayer.Update.DT is negative")}if(true){if(GLLibConfig.sprite_animFPS==1000){if(d>1){Warning("GLLibPlayer.Update was called with DT larger than 1, the player is currently working as Frame Based Player")}}else{if(d==1){Warning("GLLibPlayer.Update was called with DT equal 1, the player is currently working as a Time Based Player, it should be more than 1 ms ?")}}}if(this.animIsOver||(this.curAnim<0)){return}var e=this.GetDuration();if(GLLibConfig.sprite_animDurationZeroAsInfinite){if(e==0){return}}else{if(!(e!=0)){Assert(false,"GLLibPlayer.Update.frame "+this.curFrame+" of animation "+this.curAnim+" has a duration of 0")}}if(GLLibConfig.sprite_noFrameSkip){if(this.curTime>=e){this.curTime-=e;if(this.curFrame<this.sprite.GetAFrames(this.curAnim)-1){this.curFrame++}else{if(this.nbLoop==0){this.animIsOver=true}else{if(this.nbLoop>0){this.nbLoop--}this.curFrame=0}}}}else{while(this.curTime>=e){this.curTime-=e;if(this.curFrame<this.sprite.GetAFrames(this.curAnim)-1){this.curFrame++}else{if(this.nbLoop==0){this.animIsOver=true;break}else{if(this.nbLoop>0){this.nbLoop--}this.curFrame=0}}e=this.GetDuration();if(GLLibConfig.sprite_animDurationZeroAsInfinite){if(e==0){break}}}}this.curTime+=d};a.prototype.__GLLibPlayer_ASprite_FrameMapping__initialization__=function(){if(GLLibConfig.sprite_useFrameMapping){this.m_frameMapping_config_sprite=null;this.m_frameMapping_config_palId=null;this.m_frameMapping_config_frameOff=null}};b.GLLibPlayer=a})(window);